Python 2.7.18
Python 3.8.5
(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:04<1:05:33,  4.20s/it]  1%|          | 6/938 [00:04<08:18,  1.87it/s]    1%|▏         | 12/938 [00:04<03:28,  4.44it/s]  2%|▏         | 17/938 [00:04<02:09,  7.13it/s]  2%|▏         | 23/938 [00:04<01:21, 11.23it/s]  3%|▎         | 29/938 [00:04<00:56, 16.12it/s]  4%|▍         | 37/938 [00:04<00:37, 23.85it/s]  5%|▍         | 44/938 [00:04<00:29, 30.11it/s]  5%|▌         | 51/938 [00:05<00:24, 36.53it/s]  6%|▋         | 59/938 [00:05<00:19, 44.35it/s]  7%|▋         | 67/938 [00:05<00:16, 51.31it/s]  8%|▊         | 74/938 [00:05<00:15, 55.17it/s]  9%|▊         | 81/938 [00:05<00:14, 57.13it/s]  9%|▉         | 88/938 [00:05<00:14, 56.91it/s] 10%|█         | 95/938 [00:05<00:14, 57.72it/s] 11%|█         | 103/938 [00:05<00:13, 63.41it/s] 12%|█▏        | 110/938 [00:05<00:12, 65.12it/s] 13%|█▎        | 119/938 [00:06<00:11, 70.33it/s] 14%|█▎        | 128/938 [00:06<00:10, 73.69it/s] 14%|█▍        | 136/938 [00:06<00:11, 69.12it/s] 15%|█▌        | 144/938 [00:06<00:12, 65.33it/s] 16%|█▌        | 151/938 [00:06<00:11, 66.34it/s] 17%|█▋        | 159/938 [00:06<00:11, 69.35it/s] 18%|█▊        | 167/938 [00:06<00:10, 70.77it/s] 19%|█▊        | 175/938 [00:06<00:10, 72.02it/s] 20%|█▉        | 183/938 [00:06<00:10, 70.30it/s] 20%|██        | 191/938 [00:07<00:10, 69.64it/s] 21%|██        | 199/938 [00:07<00:10, 68.62it/s] 22%|██▏       | 207/938 [00:07<00:10, 71.54it/s] 23%|██▎       | 215/938 [00:07<00:10, 68.70it/s] 24%|██▎       | 222/938 [00:07<00:10, 67.83it/s] 24%|██▍       | 229/938 [00:07<00:10, 66.28it/s] 25%|██▌       | 236/938 [00:07<00:10, 64.17it/s] 26%|██▌       | 244/938 [00:07<00:10, 65.92it/s] 27%|██▋       | 251/938 [00:08<00:10, 63.07it/s] 28%|██▊       | 258/938 [00:08<00:10, 62.41it/s] 28%|██▊       | 265/938 [00:08<00:11, 59.09it/s] 29%|██▉       | 271/938 [00:08<00:11, 57.74it/s] 30%|██▉       | 279/938 [00:08<00:10, 62.29it/s] 30%|███       | 286/938 [00:08<00:10, 61.44it/s] 31%|███       | 293/938 [00:08<00:10, 60.16it/s] 32%|███▏      | 300/938 [00:08<00:10, 61.11it/s] 33%|███▎      | 307/938 [00:08<00:10, 57.53it/s] 33%|███▎      | 314/938 [00:09<00:10, 58.79it/s] 34%|███▍      | 320/938 [00:09<00:10, 57.48it/s] 35%|███▍      | 326/938 [00:09<00:11, 53.97it/s] 35%|███▌      | 332/938 [00:09<00:12, 48.64it/s] 36%|███▌      | 337/938 [00:09<00:12, 48.31it/s] 37%|███▋      | 343/938 [00:09<00:11, 49.72it/s] 37%|███▋      | 349/938 [00:09<00:11, 52.16it/s] 38%|███▊      | 356/938 [00:09<00:10, 55.81it/s] 39%|███▊      | 362/938 [00:10<00:10, 55.88it/s] 39%|███▉      | 368/938 [00:10<00:10, 53.79it/s] 40%|███▉      | 375/938 [00:10<00:10, 55.75it/s] 41%|████      | 381/938 [00:10<00:10, 55.16it/s] 41%|████▏     | 388/938 [00:10<00:09, 56.25it/s] 42%|████▏     | 394/938 [00:10<00:09, 56.10it/s] 43%|████▎     | 400/938 [00:10<00:09, 57.16it/s] 43%|████▎     | 406/938 [00:10<00:10, 50.35it/s] 44%|████▍     | 413/938 [00:10<00:09, 54.40it/s] 45%|████▍     | 419/938 [00:11<00:09, 53.55it/s] 46%|████▌     | 427/938 [00:11<00:08, 58.94it/s] 46%|████▋     | 434/938 [00:11<00:08, 58.70it/s] 47%|████▋     | 440/938 [00:11<00:09, 54.01it/s] 48%|████▊     | 448/938 [00:11<00:08, 59.20it/s] 49%|████▊     | 456/938 [00:11<00:07, 64.30it/s] 49%|████▉     | 463/938 [00:11<00:07, 65.07it/s] 50%|█████     | 470/938 [00:11<00:07, 61.65it/s] 51%|█████     | 477/938 [00:12<00:08, 52.36it/s] 51%|█████▏    | 483/938 [00:12<00:08, 53.23it/s] 52%|█████▏    | 492/938 [00:12<00:07, 60.79it/s] 53%|█████▎    | 499/938 [00:12<00:07, 62.33it/s] 54%|█████▍    | 506/938 [00:12<00:06, 63.05it/s] 55%|█████▍    | 513/938 [00:12<00:06, 64.31it/s] 55%|█████▌    | 520/938 [00:12<00:07, 57.74it/s] 56%|█████▌    | 526/938 [00:12<00:07, 57.54it/s] 57%|█████▋    | 532/938 [00:12<00:07, 56.79it/s] 58%|█████▊    | 540/938 [00:13<00:06, 60.59it/s] 58%|█████▊    | 547/938 [00:13<00:06, 62.46it/s] 59%|█████▉    | 554/938 [00:13<00:06, 61.48it/s] 60%|█████▉    | 561/938 [00:13<00:06, 59.15it/s] 60%|██████    | 567/938 [00:13<00:06, 58.67it/s] 61%|██████    | 574/938 [00:13<00:06, 60.34it/s] 62%|██████▏   | 581/938 [00:13<00:05, 61.37it/s] 63%|██████▎   | 588/938 [00:13<00:05, 60.85it/s] 63%|██████▎   | 595/938 [00:14<00:06, 55.70it/s] 64%|██████▍   | 601/938 [00:14<00:06, 51.69it/s] 65%|██████▍   | 609/938 [00:14<00:05, 57.38it/s] 66%|██████▌   | 615/938 [00:14<00:05, 57.51it/s] 66%|██████▋   | 622/938 [00:14<00:05, 60.25it/s] 67%|██████▋   | 629/938 [00:14<00:05, 59.08it/s] 68%|██████▊   | 635/938 [00:14<00:05, 55.87it/s] 68%|██████▊   | 641/938 [00:14<00:05, 56.05it/s] 69%|██████▉   | 649/938 [00:14<00:04, 60.80it/s] 70%|███████   | 657/938 [00:15<00:04, 64.00it/s] 71%|███████   | 664/938 [00:15<00:04, 62.52it/s] 72%|███████▏  | 671/938 [00:15<00:04, 60.78it/s] 72%|███████▏  | 678/938 [00:15<00:04, 60.48it/s] 73%|███████▎  | 685/938 [00:15<00:04, 62.49it/s] 74%|███████▍  | 692/938 [00:15<00:03, 63.72it/s] 75%|███████▍  | 700/938 [00:15<00:03, 66.12it/s] 75%|███████▌  | 707/938 [00:15<00:03, 67.02it/s] 76%|███████▌  | 714/938 [00:15<00:03, 67.48it/s] 77%|███████▋  | 721/938 [00:16<00:03, 66.70it/s] 78%|███████▊  | 728/938 [00:16<00:03, 62.70it/s] 78%|███████▊  | 736/938 [00:16<00:03, 65.33it/s] 79%|███████▉  | 744/938 [00:16<00:02, 67.29it/s] 80%|████████  | 751/938 [00:16<00:02, 65.13it/s] 81%|████████  | 759/938 [00:16<00:02, 67.23it/s] 82%|████████▏ | 766/938 [00:16<00:02, 57.56it/s] 82%|████████▏ | 772/938 [00:16<00:02, 57.55it/s] 83%|████████▎ | 779/938 [00:16<00:02, 59.90it/s] 84%|████████▍ | 787/938 [00:17<00:02, 62.90it/s] 85%|████████▍ | 794/938 [00:17<00:02, 64.48it/s] 85%|████████▌ | 801/938 [00:17<00:02, 62.62it/s] 86%|████████▌ | 808/938 [00:17<00:02, 64.56it/s] 87%|████████▋ | 815/938 [00:17<00:01, 65.06it/s] 88%|████████▊ | 822/938 [00:17<00:01, 62.83it/s] 88%|████████▊ | 830/938 [00:17<00:01, 66.79it/s] 89%|████████▉ | 838/938 [00:17<00:01, 68.56it/s] 90%|█████████ | 846/938 [00:17<00:01, 71.43it/s] 91%|█████████ | 854/938 [00:18<00:01, 67.85it/s] 92%|█████████▏| 861/938 [00:18<00:01, 66.97it/s] 93%|█████████▎| 868/938 [00:18<00:01, 67.57it/s] 93%|█████████▎| 876/938 [00:18<00:00, 70.28it/s] 94%|█████████▍| 884/938 [00:18<00:00, 70.87it/s] 95%|█████████▌| 892/938 [00:18<00:00, 70.67it/s] 96%|█████████▌| 900/938 [00:18<00:00, 69.07it/s] 97%|█████████▋| 907/938 [00:18<00:00, 66.72it/s] 97%|█████████▋| 914/938 [00:18<00:00, 63.22it/s] 98%|█████████▊| 922/938 [00:19<00:00, 67.05it/s] 99%|█████████▉| 930/938 [00:19<00:00, 69.92it/s]100%|██████████| 938/938 [00:19<00:00, 64.57it/s]100%|██████████| 938/938 [00:19<00:00, 47.95it/s]
Train Epoch: 1 	Loss: 1.023967 
Moments Accountant gives: (ε = 1265.56, δ = 1e-05) for α = 1.10
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:07,  1.25it/s] 20%|██        | 2/10 [00:00<00:03,  2.36it/s] 30%|███       | 3/10 [00:01<00:02,  3.27it/s] 40%|████      | 4/10 [00:01<00:01,  3.99it/s] 50%|█████     | 5/10 [00:01<00:01,  4.28it/s] 60%|██████    | 6/10 [00:01<00:00,  4.59it/s] 70%|███████   | 7/10 [00:01<00:00,  4.95it/s] 80%|████████  | 8/10 [00:02<00:00,  5.03it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.14it/s]100%|██████████| 10/10 [00:02<00:00,  5.77it/s]100%|██████████| 10/10 [00:02<00:00,  3.96it/s]

Test set: Average loss: 0.0006, Accuracy: 8252/10000 (82.52%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<05:03,  3.09it/s]  1%|          | 6/938 [00:00<00:55, 16.85it/s]  1%|          | 11/938 [00:00<00:35, 25.80it/s]  2%|▏         | 15/938 [00:00<00:31, 28.88it/s]  2%|▏         | 20/938 [00:00<00:28, 32.74it/s]  3%|▎         | 26/938 [00:00<00:23, 38.70it/s]  3%|▎         | 31/938 [00:01<00:23, 39.39it/s]  4%|▍         | 37/938 [00:01<00:20, 44.29it/s]  5%|▍         | 43/938 [00:01<00:18, 48.37it/s]  5%|▌         | 49/938 [00:01<00:18, 48.72it/s]  6%|▌         | 57/938 [00:01<00:15, 56.79it/s]  7%|▋         | 64/938 [00:01<00:14, 59.24it/s]  8%|▊         | 71/938 [00:01<00:15, 57.18it/s]  8%|▊         | 77/938 [00:01<00:14, 57.83it/s]  9%|▉         | 84/938 [00:01<00:14, 60.82it/s] 10%|▉         | 92/938 [00:02<00:13, 63.84it/s] 11%|█         | 100/938 [00:02<00:12, 67.30it/s] 11%|█▏        | 107/938 [00:02<00:12, 65.69it/s] 12%|█▏        | 114/938 [00:02<00:13, 62.55it/s] 13%|█▎        | 121/938 [00:02<00:12, 63.20it/s] 14%|█▍        | 129/938 [00:02<00:12, 65.77it/s] 14%|█▍        | 136/938 [00:02<00:12, 64.64it/s] 15%|█▌        | 143/938 [00:02<00:12, 65.17it/s] 16%|█▌        | 150/938 [00:02<00:12, 64.61it/s] 17%|█▋        | 157/938 [00:03<00:13, 59.45it/s] 17%|█▋        | 164/938 [00:03<00:12, 59.82it/s] 18%|█▊        | 171/938 [00:03<00:12, 61.83it/s] 19%|█▉        | 178/938 [00:03<00:11, 63.48it/s] 20%|█▉        | 185/938 [00:03<00:11, 63.73it/s] 20%|██        | 192/938 [00:03<00:12, 61.82it/s] 21%|██        | 199/938 [00:03<00:12, 59.96it/s] 22%|██▏       | 206/938 [00:03<00:12, 59.15it/s] 23%|██▎       | 212/938 [00:03<00:13, 52.11it/s] 23%|██▎       | 218/938 [00:04<00:14, 49.29it/s] 24%|██▍       | 224/938 [00:04<00:14, 50.44it/s] 25%|██▍       | 231/938 [00:04<00:13, 52.86it/s] 25%|██▌       | 238/938 [00:04<00:12, 56.05it/s] 26%|██▌       | 244/938 [00:04<00:12, 54.75it/s] 27%|██▋       | 250/938 [00:04<00:12, 54.36it/s] 27%|██▋       | 257/938 [00:04<00:12, 56.58it/s] 28%|██▊       | 263/938 [00:04<00:11, 57.37it/s] 29%|██▉       | 270/938 [00:05<00:11, 57.98it/s] 29%|██▉       | 276/938 [00:05<00:11, 56.80it/s] 30%|███       | 282/938 [00:05<00:12, 53.77it/s] 31%|███       | 288/938 [00:05<00:12, 52.05it/s] 31%|███▏      | 294/938 [00:05<00:13, 47.34it/s] 32%|███▏      | 299/938 [00:05<00:13, 47.89it/s] 33%|███▎      | 306/938 [00:05<00:12, 52.60it/s] 33%|███▎      | 312/938 [00:05<00:11, 54.29it/s] 34%|███▍      | 320/938 [00:05<00:10, 60.57it/s] 35%|███▍      | 327/938 [00:06<00:09, 61.74it/s] 36%|███▌      | 334/938 [00:06<00:09, 61.84it/s] 36%|███▋      | 341/938 [00:06<00:10, 58.05it/s] 37%|███▋      | 348/938 [00:06<00:09, 59.80it/s] 38%|███▊      | 355/938 [00:06<00:10, 57.74it/s] 38%|███▊      | 361/938 [00:06<00:10, 57.17it/s] 39%|███▉      | 367/938 [00:06<00:10, 53.32it/s] 40%|███▉      | 373/938 [00:06<00:11, 48.44it/s] 40%|████      | 379/938 [00:07<00:11, 50.04it/s] 41%|████      | 386/938 [00:07<00:10, 54.83it/s] 42%|████▏     | 393/938 [00:07<00:09, 57.67it/s] 43%|████▎     | 399/938 [00:07<00:09, 57.28it/s] 43%|████▎     | 405/938 [00:07<00:09, 54.38it/s] 44%|████▍     | 411/938 [00:07<00:09, 54.54it/s] 44%|████▍     | 417/938 [00:07<00:09, 54.91it/s] 45%|████▌     | 424/938 [00:07<00:08, 58.91it/s] 46%|████▌     | 431/938 [00:07<00:08, 58.00it/s] 47%|████▋     | 437/938 [00:08<00:08, 57.40it/s] 47%|████▋     | 444/938 [00:08<00:08, 60.21it/s] 48%|████▊     | 451/938 [00:08<00:08, 57.07it/s] 49%|████▊     | 457/938 [00:08<00:08, 56.74it/s] 49%|████▉     | 464/938 [00:08<00:08, 58.31it/s] 50%|█████     | 471/938 [00:08<00:07, 59.49it/s] 51%|█████     | 477/938 [00:08<00:07, 57.90it/s] 52%|█████▏    | 485/938 [00:08<00:07, 61.27it/s] 52%|█████▏    | 492/938 [00:08<00:07, 58.31it/s] 53%|█████▎    | 498/938 [00:09<00:07, 58.30it/s] 54%|█████▍    | 505/938 [00:09<00:07, 59.56it/s] 55%|█████▍    | 512/938 [00:09<00:07, 60.64it/s] 55%|█████▌    | 519/938 [00:09<00:06, 61.78it/s] 56%|█████▌    | 526/938 [00:09<00:06, 59.51it/s] 57%|█████▋    | 532/938 [00:09<00:06, 58.42it/s] 58%|█████▊    | 541/938 [00:09<00:06, 65.91it/s] 59%|█████▊    | 550/938 [00:09<00:05, 70.48it/s] 59%|█████▉    | 558/938 [00:10<00:05, 67.79it/s] 60%|██████    | 565/938 [00:10<00:05, 66.05it/s] 61%|██████    | 572/938 [00:10<00:06, 58.39it/s] 62%|██████▏   | 578/938 [00:10<00:06, 54.74it/s] 62%|██████▏   | 585/938 [00:10<00:06, 56.70it/s] 63%|██████▎   | 591/938 [00:10<00:06, 53.83it/s] 64%|██████▎   | 597/938 [00:10<00:06, 52.38it/s] 64%|██████▍   | 603/938 [00:10<00:06, 51.32it/s] 65%|██████▍   | 609/938 [00:10<00:06, 52.82it/s] 66%|██████▌   | 615/938 [00:11<00:06, 53.47it/s] 66%|██████▋   | 622/938 [00:11<00:05, 56.11it/s] 67%|██████▋   | 628/938 [00:11<00:05, 56.39it/s] 68%|██████▊   | 635/938 [00:11<00:05, 58.46it/s] 68%|██████▊   | 642/938 [00:11<00:04, 59.61it/s] 69%|██████▉   | 648/938 [00:11<00:04, 59.09it/s] 70%|██████▉   | 656/938 [00:11<00:04, 62.83it/s] 71%|███████   | 663/938 [00:11<00:04, 58.29it/s] 71%|███████▏  | 669/938 [00:12<00:04, 56.10it/s] 72%|███████▏  | 675/938 [00:12<00:04, 55.47it/s] 73%|███████▎  | 682/938 [00:12<00:04, 58.78it/s] 73%|███████▎  | 689/938 [00:12<00:04, 61.62it/s] 74%|███████▍  | 696/938 [00:12<00:03, 61.95it/s] 75%|███████▍  | 703/938 [00:12<00:04, 56.86it/s] 76%|███████▌  | 709/938 [00:12<00:04, 56.78it/s] 76%|███████▌  | 715/938 [00:12<00:03, 57.33it/s] 77%|███████▋  | 723/938 [00:12<00:03, 61.73it/s] 78%|███████▊  | 730/938 [00:13<00:03, 62.63it/s] 79%|███████▊  | 738/938 [00:13<00:03, 64.69it/s] 79%|███████▉  | 745/938 [00:13<00:03, 63.43it/s] 80%|████████  | 752/938 [00:13<00:03, 56.68it/s] 81%|████████  | 759/938 [00:13<00:03, 58.02it/s] 82%|████████▏ | 765/938 [00:13<00:03, 57.20it/s] 82%|████████▏ | 772/938 [00:13<00:02, 58.78it/s] 83%|████████▎ | 779/938 [00:13<00:02, 59.21it/s] 84%|████████▎ | 785/938 [00:13<00:02, 56.86it/s] 84%|████████▍ | 791/938 [00:14<00:02, 57.16it/s] 85%|████████▌ | 799/938 [00:14<00:02, 62.59it/s] 86%|████████▌ | 806/938 [00:14<00:02, 62.04it/s] 87%|████████▋ | 813/938 [00:14<00:02, 60.27it/s] 87%|████████▋ | 820/938 [00:14<00:01, 60.59it/s] 88%|████████▊ | 827/938 [00:14<00:01, 58.42it/s] 89%|████████▉ | 834/938 [00:14<00:01, 60.10it/s] 90%|████████▉ | 841/938 [00:14<00:01, 62.29it/s] 90%|█████████ | 848/938 [00:15<00:01, 58.63it/s] 91%|█████████ | 854/938 [00:15<00:01, 57.55it/s] 92%|█████████▏| 860/938 [00:15<00:01, 56.13it/s] 92%|█████████▏| 867/938 [00:15<00:01, 59.44it/s] 93%|█████████▎| 874/938 [00:15<00:01, 59.82it/s] 94%|█████████▍| 881/938 [00:15<00:00, 59.23it/s] 95%|█████████▍| 887/938 [00:15<00:00, 55.15it/s] 95%|█████████▌| 893/938 [00:15<00:00, 52.70it/s] 96%|█████████▌| 900/938 [00:15<00:00, 56.89it/s] 97%|█████████▋| 908/938 [00:16<00:00, 62.05it/s] 98%|█████████▊| 915/938 [00:16<00:00, 63.27it/s] 98%|█████████▊| 923/938 [00:16<00:00, 65.52it/s] 99%|█████████▉| 930/938 [00:16<00:00, 64.55it/s]100%|█████████▉| 937/938 [00:16<00:00, 63.24it/s]100%|██████████| 938/938 [00:16<00:00, 56.22it/s]
Train Epoch: 2 	Loss: 0.581117 
Moments Accountant gives: (ε = 2416.00, δ = 1e-05) for α = 1.10
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.37it/s] 20%|██        | 2/10 [00:00<00:03,  2.39it/s] 30%|███       | 3/10 [00:01<00:02,  3.07it/s] 40%|████      | 4/10 [00:01<00:01,  3.68it/s] 50%|█████     | 5/10 [00:01<00:01,  4.31it/s] 60%|██████    | 6/10 [00:01<00:00,  4.55it/s] 70%|███████   | 7/10 [00:01<00:00,  4.94it/s] 80%|████████  | 8/10 [00:02<00:00,  5.29it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.35it/s]100%|██████████| 10/10 [00:02<00:00,  5.76it/s]100%|██████████| 10/10 [00:02<00:00,  3.92it/s]

Test set: Average loss: 0.0005, Accuracy: 8963/10000 (89.63%)

Training membership inference attack model
Base model accuracy:  0.8963
Random forest model attack results: 
train acc: 0.9996166666666667
test acc: 0.5005
total acc: 0.9283142857142858
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:12,  1.39s/it] 20%|██        | 2/10 [00:01<00:05,  1.40it/s] 30%|███       | 3/10 [00:01<00:03,  1.95it/s] 40%|████      | 4/10 [00:02<00:02,  2.47it/s] 50%|█████     | 5/10 [00:02<00:01,  2.81it/s] 60%|██████    | 6/10 [00:02<00:01,  3.10it/s] 70%|███████   | 7/10 [00:02<00:00,  3.34it/s] 80%|████████  | 8/10 [00:03<00:00,  3.56it/s] 90%|█████████ | 9/10 [00:03<00:00,  3.79it/s]100%|██████████| 10/10 [00:03<00:00,  4.14it/s]100%|██████████| 10/10 [00:03<00:00,  2.58it/s]

Test set: Average loss: 0.0005, Accuracy: 8963/10000 (89.63%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:03<57:32,  3.68s/it]  1%|          | 8/938 [00:03<05:23,  2.87it/s]  2%|▏         | 15/938 [00:03<02:27,  6.25it/s]  2%|▏         | 21/938 [00:04<01:33,  9.77it/s]  3%|▎         | 29/938 [00:04<00:57, 15.74it/s]  4%|▎         | 35/938 [00:04<00:44, 20.50it/s]  4%|▍         | 41/938 [00:04<00:36, 24.69it/s]  5%|▌         | 48/938 [00:04<00:28, 31.58it/s]  6%|▌         | 56/938 [00:04<00:22, 39.58it/s]  7%|▋         | 64/938 [00:04<00:18, 47.14it/s]  8%|▊         | 71/938 [00:04<00:16, 51.05it/s]  8%|▊         | 78/938 [00:04<00:16, 52.14it/s]  9%|▉         | 85/938 [00:05<00:16, 52.87it/s] 10%|▉         | 92/938 [00:05<00:15, 55.27it/s] 11%|█         | 100/938 [00:05<00:14, 59.51it/s] 12%|█▏        | 108/938 [00:05<00:13, 62.48it/s] 12%|█▏        | 115/938 [00:05<00:12, 63.51it/s] 13%|█▎        | 122/938 [00:05<00:13, 60.32it/s] 14%|█▍        | 129/938 [00:05<00:13, 58.94it/s] 14%|█▍        | 136/938 [00:05<00:13, 61.05it/s] 15%|█▌        | 143/938 [00:05<00:12, 62.82it/s] 16%|█▌        | 151/938 [00:06<00:11, 66.64it/s] 17%|█▋        | 158/938 [00:06<00:13, 56.64it/s] 17%|█▋        | 164/938 [00:06<00:13, 56.41it/s] 18%|█▊        | 172/938 [00:06<00:12, 61.34it/s] 19%|█▉        | 179/938 [00:06<00:12, 63.22it/s] 20%|█▉        | 187/938 [00:06<00:11, 65.61it/s] 21%|██        | 194/938 [00:06<00:11, 66.41it/s] 21%|██▏       | 201/938 [00:06<00:12, 60.89it/s] 22%|██▏       | 208/938 [00:07<00:12, 58.27it/s] 23%|██▎       | 217/938 [00:07<00:11, 63.88it/s] 24%|██▍       | 225/938 [00:07<00:10, 67.64it/s] 25%|██▍       | 232/938 [00:07<00:10, 66.26it/s] 25%|██▌       | 239/938 [00:07<00:10, 66.13it/s] 26%|██▌       | 246/938 [00:07<00:10, 64.13it/s] 27%|██▋       | 254/938 [00:07<00:10, 66.29it/s] 28%|██▊       | 261/938 [00:07<00:10, 63.75it/s] 29%|██▊       | 268/938 [00:07<00:10, 64.41it/s] 29%|██▉       | 275/938 [00:08<00:10, 64.05it/s] 30%|███       | 282/938 [00:08<00:10, 59.74it/s] 31%|███       | 289/938 [00:08<00:11, 58.79it/s] 32%|███▏      | 297/938 [00:08<00:10, 62.55it/s] 33%|███▎      | 305/938 [00:08<00:09, 65.99it/s] 33%|███▎      | 312/938 [00:08<00:09, 64.29it/s] 34%|███▍      | 319/938 [00:08<00:10, 58.78it/s] 35%|███▍      | 325/938 [00:08<00:10, 57.23it/s] 35%|███▌      | 331/938 [00:08<00:10, 57.47it/s] 36%|███▌      | 337/938 [00:09<00:10, 56.26it/s] 37%|███▋      | 345/938 [00:09<00:09, 61.51it/s] 38%|███▊      | 352/938 [00:09<00:09, 62.18it/s] 38%|███▊      | 359/938 [00:09<00:09, 61.57it/s] 39%|███▉      | 367/938 [00:09<00:08, 65.45it/s] 40%|████      | 376/938 [00:09<00:07, 71.26it/s] 41%|████      | 385/938 [00:09<00:07, 75.54it/s] 42%|████▏     | 393/938 [00:09<00:07, 73.44it/s] 43%|████▎     | 401/938 [00:09<00:07, 70.94it/s] 44%|████▎     | 409/938 [00:10<00:08, 59.54it/s] 44%|████▍     | 416/938 [00:10<00:10, 50.35it/s] 45%|████▍     | 422/938 [00:10<00:12, 42.22it/s] 46%|████▌     | 427/938 [00:10<00:12, 39.74it/s] 46%|████▌     | 432/938 [00:10<00:14, 35.57it/s] 46%|████▋     | 436/938 [00:11<00:15, 31.90it/s] 47%|████▋     | 440/938 [00:11<00:15, 31.26it/s] 47%|████▋     | 444/938 [00:11<00:17, 29.00it/s] 48%|████▊     | 447/938 [00:11<00:17, 28.86it/s] 48%|████▊     | 450/938 [00:11<00:17, 28.12it/s] 48%|████▊     | 453/938 [00:11<00:17, 27.52it/s] 49%|████▊     | 456/938 [00:11<00:17, 26.99it/s] 49%|████▉     | 459/938 [00:11<00:18, 25.43it/s] 49%|████▉     | 462/938 [00:12<00:17, 26.52it/s] 50%|████▉     | 466/938 [00:12<00:16, 28.02it/s] 50%|█████     | 470/938 [00:12<00:15, 30.18it/s] 51%|█████     | 475/938 [00:12<00:13, 34.35it/s] 51%|█████     | 480/938 [00:12<00:12, 37.86it/s] 52%|█████▏    | 485/938 [00:12<00:11, 40.45it/s] 52%|█████▏    | 491/938 [00:12<00:09, 44.78it/s] 53%|█████▎    | 497/938 [00:12<00:09, 47.18it/s] 54%|█████▎    | 503/938 [00:12<00:08, 48.53it/s] 54%|█████▍    | 510/938 [00:13<00:08, 52.34it/s] 55%|█████▌    | 517/938 [00:13<00:07, 55.21it/s] 56%|█████▌    | 524/938 [00:13<00:07, 56.96it/s] 57%|█████▋    | 530/938 [00:13<00:07, 57.55it/s] 57%|█████▋    | 537/938 [00:13<00:06, 59.61it/s] 58%|█████▊    | 543/938 [00:13<00:06, 56.95it/s] 59%|█████▊    | 549/938 [00:13<00:07, 51.37it/s] 59%|█████▉    | 555/938 [00:13<00:08, 44.53it/s] 60%|█████▉    | 560/938 [00:14<00:09, 38.61it/s] 60%|██████    | 565/938 [00:14<00:09, 40.45it/s] 61%|██████    | 571/938 [00:14<00:08, 44.85it/s] 61%|██████▏   | 576/938 [00:14<00:08, 43.60it/s] 62%|██████▏   | 581/938 [00:14<00:08, 40.36it/s] 62%|██████▏   | 586/938 [00:14<00:08, 42.22it/s] 63%|██████▎   | 592/938 [00:14<00:07, 45.53it/s] 64%|██████▍   | 598/938 [00:14<00:07, 46.08it/s] 64%|██████▍   | 603/938 [00:15<00:07, 45.03it/s] 65%|██████▍   | 608/938 [00:15<00:07, 44.77it/s] 65%|██████▌   | 614/938 [00:15<00:06, 47.76it/s] 66%|██████▌   | 619/938 [00:15<00:06, 48.07it/s] 67%|██████▋   | 624/938 [00:15<00:06, 47.15it/s] 67%|██████▋   | 630/938 [00:15<00:06, 49.84it/s] 68%|██████▊   | 637/938 [00:15<00:05, 53.13it/s] 69%|██████▊   | 644/938 [00:15<00:05, 56.69it/s] 69%|██████▉   | 651/938 [00:15<00:04, 58.17it/s] 70%|███████   | 657/938 [00:16<00:05, 51.69it/s] 71%|███████   | 663/938 [00:16<00:05, 46.69it/s] 71%|███████   | 668/938 [00:16<00:05, 46.36it/s] 72%|███████▏  | 675/938 [00:16<00:05, 50.84it/s] 73%|███████▎  | 683/938 [00:16<00:04, 56.49it/s] 74%|███████▎  | 690/938 [00:16<00:04, 59.95it/s] 74%|███████▍  | 697/938 [00:16<00:04, 55.00it/s] 75%|███████▍  | 703/938 [00:17<00:04, 49.71it/s] 76%|███████▌  | 709/938 [00:17<00:04, 51.47it/s] 76%|███████▌  | 715/938 [00:17<00:04, 53.28it/s] 77%|███████▋  | 721/938 [00:17<00:04, 50.69it/s] 78%|███████▊  | 727/938 [00:17<00:04, 52.15it/s] 78%|███████▊  | 735/938 [00:17<00:03, 59.28it/s] 79%|███████▉  | 743/938 [00:17<00:03, 62.73it/s] 80%|████████  | 751/938 [00:17<00:02, 63.84it/s] 81%|████████  | 758/938 [00:17<00:03, 55.03it/s] 81%|████████▏ | 764/938 [00:18<00:03, 54.75it/s] 82%|████████▏ | 770/938 [00:18<00:03, 54.62it/s] 83%|████████▎ | 776/938 [00:18<00:03, 50.92it/s] 83%|████████▎ | 783/938 [00:18<00:02, 55.49it/s] 84%|████████▍ | 792/938 [00:18<00:02, 62.47it/s] 85%|████████▌ | 799/938 [00:18<00:02, 62.08it/s] 86%|████████▌ | 807/938 [00:18<00:02, 64.67it/s] 87%|████████▋ | 816/938 [00:18<00:01, 69.41it/s] 88%|████████▊ | 824/938 [00:18<00:01, 71.19it/s] 89%|████████▊ | 832/938 [00:19<00:01, 71.51it/s] 90%|████████▉ | 840/938 [00:19<00:01, 68.68it/s] 90%|█████████ | 847/938 [00:19<00:01, 65.44it/s] 91%|█████████ | 854/938 [00:19<00:01, 64.22it/s] 92%|█████████▏| 861/938 [00:19<00:01, 62.26it/s] 93%|█████████▎| 868/938 [00:19<00:01, 53.15it/s] 93%|█████████▎| 874/938 [00:19<00:01, 45.34it/s] 94%|█████████▎| 879/938 [00:20<00:01, 42.75it/s] 94%|█████████▍| 886/938 [00:20<00:01, 47.76it/s] 95%|█████████▌| 893/938 [00:20<00:00, 51.80it/s] 96%|█████████▌| 900/938 [00:20<00:00, 55.34it/s] 97%|█████████▋| 906/938 [00:20<00:00, 53.31it/s] 97%|█████████▋| 912/938 [00:20<00:00, 47.92it/s] 98%|█████████▊| 917/938 [00:20<00:00, 48.38it/s] 98%|█████████▊| 922/938 [00:20<00:00, 48.66it/s] 99%|█████████▉| 928/938 [00:21<00:00, 50.78it/s]100%|█████████▉| 934/938 [00:21<00:00, 52.72it/s]100%|██████████| 938/938 [00:21<00:00, 43.95it/s]
Train Epoch: 1 	Loss: 0.956091 
Moments Accountant gives: (ε = 77.61, δ = 1e-05) for α = 1.20
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:07,  1.21it/s] 20%|██        | 2/10 [00:01<00:04,  1.93it/s] 30%|███       | 3/10 [00:01<00:02,  2.73it/s] 40%|████      | 4/10 [00:01<00:01,  3.04it/s] 50%|█████     | 5/10 [00:01<00:01,  3.02it/s] 60%|██████    | 6/10 [00:02<00:01,  3.50it/s] 70%|███████   | 7/10 [00:02<00:00,  3.82it/s] 80%|████████  | 8/10 [00:02<00:00,  4.12it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.41it/s]100%|██████████| 10/10 [00:02<00:00,  5.13it/s]100%|██████████| 10/10 [00:03<00:00,  3.23it/s]

Test set: Average loss: 0.0005, Accuracy: 8533/10000 (85.33%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<05:07,  3.04it/s]  1%|          | 9/938 [00:00<00:35, 25.98it/s]  2%|▏         | 16/938 [00:00<00:23, 38.50it/s]  2%|▏         | 23/938 [00:00<00:19, 46.76it/s]  3%|▎         | 29/938 [00:00<00:18, 50.15it/s]  4%|▎         | 35/938 [00:00<00:19, 46.22it/s]  4%|▍         | 42/938 [00:01<00:17, 51.46it/s]  5%|▌         | 49/938 [00:01<00:16, 55.47it/s]  6%|▌         | 55/938 [00:01<00:15, 56.04it/s]  7%|▋         | 61/938 [00:01<00:15, 55.97it/s]  7%|▋         | 67/938 [00:01<00:15, 54.84it/s]  8%|▊         | 74/938 [00:01<00:15, 57.11it/s]  9%|▊         | 81/938 [00:01<00:14, 58.92it/s]  9%|▉         | 88/938 [00:01<00:13, 61.82it/s] 10%|█         | 95/938 [00:01<00:14, 56.33it/s] 11%|█         | 102/938 [00:02<00:14, 58.72it/s] 12%|█▏        | 108/938 [00:02<00:14, 57.30it/s] 12%|█▏        | 115/938 [00:02<00:13, 60.52it/s] 13%|█▎        | 122/938 [00:02<00:14, 56.21it/s] 14%|█▍        | 129/938 [00:02<00:13, 58.31it/s] 14%|█▍        | 135/938 [00:02<00:13, 58.69it/s] 15%|█▌        | 141/938 [00:02<00:15, 52.91it/s] 16%|█▌        | 147/938 [00:02<00:14, 54.07it/s] 16%|█▋        | 153/938 [00:02<00:14, 55.53it/s] 17%|█▋        | 160/938 [00:03<00:13, 58.07it/s] 18%|█▊        | 166/938 [00:03<00:13, 55.76it/s] 18%|█▊        | 173/938 [00:03<00:13, 56.98it/s] 19%|█▉        | 180/938 [00:03<00:13, 57.36it/s] 20%|█▉        | 186/938 [00:03<00:12, 57.93it/s] 21%|██        | 193/938 [00:03<00:12, 61.20it/s] 21%|██▏       | 200/938 [00:03<00:13, 56.49it/s] 22%|██▏       | 206/938 [00:03<00:13, 53.57it/s] 23%|██▎       | 213/938 [00:03<00:13, 55.45it/s] 23%|██▎       | 220/938 [00:04<00:12, 56.80it/s] 24%|██▍       | 227/938 [00:04<00:12, 58.17it/s] 25%|██▍       | 234/938 [00:04<00:11, 61.03it/s] 26%|██▌       | 242/938 [00:04<00:10, 64.89it/s] 27%|██▋       | 249/938 [00:04<00:10, 66.00it/s] 27%|██▋       | 256/938 [00:04<00:10, 65.51it/s] 28%|██▊       | 264/938 [00:04<00:09, 67.89it/s] 29%|██▉       | 271/938 [00:04<00:09, 67.01it/s] 30%|██▉       | 278/938 [00:04<00:10, 64.08it/s] 30%|███       | 285/938 [00:05<00:10, 64.18it/s] 31%|███       | 293/938 [00:05<00:09, 66.91it/s] 32%|███▏      | 300/938 [00:05<00:10, 59.43it/s] 33%|███▎      | 307/938 [00:05<00:10, 58.11it/s] 33%|███▎      | 313/938 [00:05<00:10, 57.06it/s] 34%|███▍      | 320/938 [00:05<00:10, 57.46it/s] 35%|███▍      | 326/938 [00:05<00:11, 55.30it/s] 36%|███▌      | 335/938 [00:05<00:09, 61.91it/s] 37%|███▋      | 344/938 [00:06<00:08, 67.03it/s] 38%|███▊      | 352/938 [00:06<00:08, 68.29it/s] 38%|███▊      | 359/938 [00:06<00:10, 53.57it/s] 39%|███▉      | 365/938 [00:06<00:10, 54.67it/s] 40%|███▉      | 372/938 [00:06<00:09, 57.08it/s] 40%|████      | 379/938 [00:06<00:09, 58.52it/s] 41%|████      | 386/938 [00:06<00:09, 59.95it/s] 42%|████▏     | 393/938 [00:06<00:10, 54.32it/s] 43%|████▎     | 399/938 [00:07<00:10, 51.26it/s] 43%|████▎     | 406/938 [00:07<00:10, 52.98it/s] 44%|████▍     | 412/938 [00:07<00:09, 53.24it/s] 45%|████▍     | 418/938 [00:07<00:09, 53.06it/s] 45%|████▌     | 425/938 [00:07<00:09, 55.20it/s] 46%|████▌     | 431/938 [00:07<00:09, 55.21it/s] 47%|████▋     | 437/938 [00:07<00:09, 52.31it/s] 47%|████▋     | 443/938 [00:07<00:09, 53.52it/s] 48%|████▊     | 451/938 [00:08<00:08, 58.80it/s] 49%|████▉     | 459/938 [00:08<00:07, 61.94it/s] 50%|████▉     | 466/938 [00:08<00:07, 59.83it/s] 50%|█████     | 473/938 [00:08<00:07, 60.58it/s] 51%|█████     | 480/938 [00:08<00:07, 62.83it/s] 52%|█████▏    | 487/938 [00:08<00:07, 63.08it/s] 53%|█████▎    | 494/938 [00:08<00:06, 64.69it/s] 53%|█████▎    | 501/938 [00:08<00:07, 55.32it/s] 54%|█████▍    | 507/938 [00:08<00:07, 55.65it/s] 55%|█████▍    | 513/938 [00:09<00:07, 55.27it/s] 55%|█████▌    | 520/938 [00:09<00:07, 56.60it/s] 56%|█████▋    | 528/938 [00:09<00:06, 61.76it/s] 57%|█████▋    | 536/938 [00:09<00:06, 65.06it/s] 58%|█████▊    | 544/938 [00:09<00:05, 68.92it/s] 59%|█████▊    | 551/938 [00:09<00:05, 69.17it/s] 59%|█████▉    | 558/938 [00:09<00:05, 67.16it/s] 60%|██████    | 565/938 [00:09<00:06, 59.02it/s] 61%|██████    | 572/938 [00:09<00:06, 59.71it/s] 62%|██████▏   | 581/938 [00:10<00:05, 65.38it/s] 63%|██████▎   | 590/938 [00:10<00:04, 69.68it/s] 64%|██████▍   | 598/938 [00:10<00:04, 69.06it/s] 64%|██████▍   | 605/938 [00:10<00:05, 65.76it/s] 65%|██████▌   | 612/938 [00:10<00:04, 65.99it/s] 66%|██████▌   | 619/938 [00:10<00:05, 61.11it/s] 67%|██████▋   | 627/938 [00:10<00:04, 66.05it/s] 68%|██████▊   | 635/938 [00:10<00:04, 68.14it/s] 68%|██████▊   | 642/938 [00:11<00:04, 63.57it/s] 69%|██████▉   | 649/938 [00:11<00:04, 63.05it/s] 70%|███████   | 657/938 [00:11<00:04, 65.28it/s] 71%|███████   | 666/938 [00:11<00:03, 70.25it/s] 72%|███████▏  | 674/938 [00:11<00:03, 72.43it/s] 73%|███████▎  | 682/938 [00:11<00:03, 74.53it/s] 74%|███████▎  | 690/938 [00:11<00:03, 71.96it/s] 74%|███████▍  | 698/938 [00:11<00:03, 67.14it/s] 75%|███████▌  | 706/938 [00:11<00:03, 67.55it/s] 76%|███████▌  | 714/938 [00:12<00:03, 68.87it/s] 77%|███████▋  | 721/938 [00:12<00:03, 68.85it/s] 78%|███████▊  | 728/938 [00:12<00:03, 67.22it/s] 78%|███████▊  | 735/938 [00:12<00:03, 62.65it/s] 79%|███████▉  | 742/938 [00:12<00:03, 64.36it/s] 80%|███████▉  | 749/938 [00:12<00:02, 64.52it/s] 81%|████████  | 756/938 [00:12<00:02, 64.47it/s] 81%|████████▏ | 763/938 [00:12<00:02, 66.00it/s] 82%|████████▏ | 770/938 [00:12<00:02, 57.48it/s] 83%|████████▎ | 776/938 [00:13<00:02, 57.26it/s] 83%|████████▎ | 783/938 [00:13<00:02, 59.64it/s] 84%|████████▍ | 791/938 [00:13<00:02, 63.22it/s] 85%|████████▌ | 798/938 [00:13<00:02, 60.06it/s] 86%|████████▌ | 805/938 [00:13<00:02, 59.90it/s] 87%|████████▋ | 812/938 [00:13<00:02, 59.79it/s] 87%|████████▋ | 819/938 [00:13<00:01, 60.80it/s] 88%|████████▊ | 827/938 [00:13<00:01, 63.78it/s] 89%|████████▉ | 835/938 [00:13<00:01, 66.22it/s] 90%|████████▉ | 842/938 [00:14<00:01, 64.19it/s] 91%|█████████ | 849/938 [00:14<00:01, 63.38it/s] 91%|█████████▏| 856/938 [00:14<00:01, 62.51it/s] 92%|█████████▏| 863/938 [00:14<00:01, 61.83it/s] 93%|█████████▎| 870/938 [00:14<00:01, 63.60it/s] 94%|█████████▎| 878/938 [00:14<00:00, 67.61it/s] 94%|█████████▍| 886/938 [00:14<00:00, 69.17it/s] 95%|█████████▌| 893/938 [00:14<00:00, 67.98it/s] 96%|█████████▌| 900/938 [00:15<00:00, 64.07it/s] 97%|█████████▋| 907/938 [00:15<00:00, 62.80it/s] 98%|█████████▊| 915/938 [00:15<00:00, 65.59it/s] 98%|█████████▊| 922/938 [00:15<00:00, 65.25it/s] 99%|█████████▉| 929/938 [00:15<00:00, 64.44it/s]100%|█████████▉| 936/938 [00:15<00:00, 61.69it/s]100%|██████████| 938/938 [00:15<00:00, 59.21it/s]
Train Epoch: 2 	Loss: 0.486246 
Moments Accountant gives: (ε = 97.66, δ = 1e-05) for α = 1.20
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.32it/s] 20%|██        | 2/10 [00:00<00:03,  2.41it/s] 30%|███       | 3/10 [00:01<00:02,  3.31it/s] 40%|████      | 4/10 [00:01<00:01,  3.94it/s] 50%|█████     | 5/10 [00:01<00:01,  4.35it/s] 60%|██████    | 6/10 [00:01<00:00,  4.89it/s] 70%|███████   | 7/10 [00:01<00:00,  5.30it/s] 80%|████████  | 8/10 [00:01<00:00,  5.20it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.93it/s]100%|██████████| 10/10 [00:02<00:00,  5.56it/s]100%|██████████| 10/10 [00:02<00:00,  3.96it/s]

Test set: Average loss: 0.0004, Accuracy: 9047/10000 (90.47%)

Training membership inference attack model
Base model accuracy:  0.9047
Random forest model attack results: 
train acc: 0.99975
test acc: 0.5009
total acc: 0.9284857142857142
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.30it/s] 20%|██        | 2/10 [00:00<00:03,  2.24it/s] 30%|███       | 3/10 [00:01<00:02,  3.08it/s] 40%|████      | 4/10 [00:01<00:01,  3.87it/s] 50%|█████     | 5/10 [00:01<00:01,  4.35it/s] 60%|██████    | 6/10 [00:01<00:00,  4.70it/s] 70%|███████   | 7/10 [00:01<00:00,  5.19it/s] 80%|████████  | 8/10 [00:01<00:00,  5.51it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.39it/s]100%|██████████| 10/10 [00:02<00:00,  6.14it/s]100%|██████████| 10/10 [00:02<00:00,  4.02it/s]

Test set: Average loss: 0.0004, Accuracy: 9047/10000 (90.47%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:03<54:39,  3.50s/it]  1%|          | 10/938 [00:03<04:04,  3.79it/s]  2%|▏         | 19/938 [00:03<01:50,  8.34it/s]  3%|▎         | 28/938 [00:03<01:05, 13.99it/s]  4%|▍         | 37/938 [00:03<00:43, 20.73it/s]  5%|▍         | 45/938 [00:04<00:33, 26.67it/s]  6%|▌         | 53/938 [00:04<00:26, 33.51it/s]  7%|▋         | 62/938 [00:04<00:20, 41.95it/s]  8%|▊         | 71/938 [00:04<00:17, 50.19it/s]  9%|▊         | 80/938 [00:04<00:14, 57.83it/s]  9%|▉         | 89/938 [00:04<00:13, 61.63it/s] 10%|█         | 97/938 [00:04<00:13, 62.75it/s] 11%|█         | 105/938 [00:04<00:12, 66.08it/s] 12%|█▏        | 113/938 [00:04<00:13, 63.19it/s] 13%|█▎        | 120/938 [00:05<00:12, 63.90it/s] 14%|█▎        | 128/938 [00:05<00:12, 66.35it/s] 14%|█▍        | 135/938 [00:05<00:12, 66.05it/s] 15%|█▌        | 144/938 [00:05<00:11, 71.85it/s] 16%|█▋        | 153/938 [00:05<00:10, 74.73it/s] 17%|█▋        | 162/938 [00:05<00:10, 76.92it/s] 18%|█▊        | 170/938 [00:05<00:09, 77.19it/s] 19%|█▉        | 178/938 [00:05<00:10, 74.82it/s] 20%|█▉        | 186/938 [00:05<00:09, 76.17it/s] 21%|██        | 195/938 [00:06<00:09, 78.32it/s] 22%|██▏       | 204/938 [00:06<00:09, 79.79it/s] 23%|██▎       | 213/938 [00:06<00:08, 81.29it/s] 24%|██▎       | 222/938 [00:06<00:09, 79.29it/s] 25%|██▍       | 230/938 [00:06<00:09, 75.63it/s] 25%|██▌       | 238/938 [00:06<00:09, 76.34it/s] 26%|██▋       | 247/938 [00:06<00:08, 79.01it/s] 27%|██▋       | 256/938 [00:06<00:08, 80.11it/s] 28%|██▊       | 265/938 [00:06<00:08, 80.77it/s] 29%|██▉       | 274/938 [00:07<00:08, 77.72it/s] 30%|███       | 282/938 [00:07<00:08, 77.51it/s] 31%|███       | 292/938 [00:07<00:08, 79.77it/s] 32%|███▏      | 302/938 [00:07<00:07, 83.76it/s] 33%|███▎      | 311/938 [00:07<00:07, 78.86it/s] 34%|███▍      | 319/938 [00:07<00:07, 77.80it/s] 35%|███▍      | 328/938 [00:07<00:07, 79.35it/s] 36%|███▌      | 337/938 [00:07<00:07, 81.83it/s] 37%|███▋      | 346/938 [00:07<00:07, 83.85it/s] 38%|███▊      | 355/938 [00:08<00:07, 80.50it/s] 39%|███▉      | 364/938 [00:08<00:07, 77.17it/s] 40%|███▉      | 373/938 [00:08<00:07, 80.37it/s] 41%|████      | 382/938 [00:08<00:06, 82.36it/s] 42%|████▏     | 391/938 [00:08<00:06, 84.42it/s] 43%|████▎     | 400/938 [00:08<00:06, 81.69it/s] 44%|████▎     | 409/938 [00:08<00:06, 81.42it/s] 45%|████▍     | 418/938 [00:08<00:06, 80.15it/s] 46%|████▌     | 427/938 [00:08<00:06, 82.22it/s] 46%|████▋     | 436/938 [00:09<00:06, 80.10it/s] 47%|████▋     | 445/938 [00:09<00:06, 75.90it/s] 48%|████▊     | 454/938 [00:09<00:06, 77.34it/s] 49%|████▉     | 463/938 [00:09<00:05, 80.11it/s] 50%|█████     | 472/938 [00:09<00:06, 70.49it/s] 51%|█████     | 480/938 [00:09<00:06, 70.82it/s] 52%|█████▏    | 488/938 [00:09<00:06, 72.20it/s] 53%|█████▎    | 498/938 [00:09<00:05, 77.52it/s] 54%|█████▍    | 507/938 [00:09<00:05, 79.61it/s] 55%|█████▌    | 517/938 [00:10<00:05, 82.16it/s] 56%|█████▌    | 526/938 [00:10<00:05, 79.27it/s] 57%|█████▋    | 534/938 [00:10<00:05, 77.59it/s] 58%|█████▊    | 543/938 [00:10<00:04, 79.18it/s] 59%|█████▉    | 552/938 [00:10<00:04, 81.47it/s] 60%|█████▉    | 561/938 [00:10<00:04, 82.19it/s] 61%|██████    | 570/938 [00:10<00:04, 80.78it/s] 62%|██████▏   | 579/938 [00:10<00:04, 76.87it/s] 63%|██████▎   | 587/938 [00:11<00:04, 71.25it/s] 64%|██████▎   | 597/938 [00:11<00:04, 76.75it/s] 64%|██████▍   | 605/938 [00:11<00:04, 72.19it/s] 65%|██████▌   | 613/938 [00:11<00:04, 73.13it/s] 66%|██████▌   | 621/938 [00:11<00:04, 72.63it/s] 67%|██████▋   | 630/938 [00:11<00:03, 77.15it/s] 68%|██████▊   | 639/938 [00:11<00:03, 80.13it/s] 69%|██████▉   | 648/938 [00:11<00:03, 82.60it/s] 70%|███████   | 657/938 [00:11<00:03, 79.86it/s] 71%|███████   | 666/938 [00:12<00:03, 78.15it/s] 72%|███████▏  | 676/938 [00:12<00:03, 81.42it/s] 73%|███████▎  | 685/938 [00:12<00:03, 83.74it/s] 74%|███████▍  | 695/938 [00:12<00:02, 85.54it/s] 75%|███████▌  | 704/938 [00:12<00:02, 79.27it/s] 76%|███████▌  | 713/938 [00:12<00:02, 76.70it/s] 77%|███████▋  | 722/938 [00:12<00:02, 79.89it/s] 78%|███████▊  | 731/938 [00:12<00:02, 82.10it/s] 79%|███████▉  | 741/938 [00:12<00:02, 84.65it/s] 80%|███████▉  | 750/938 [00:13<00:02, 80.11it/s] 81%|████████  | 759/938 [00:13<00:02, 79.07it/s] 82%|████████▏ | 768/938 [00:13<00:02, 81.30it/s] 83%|████████▎ | 778/938 [00:13<00:01, 84.20it/s] 84%|████████▍ | 788/938 [00:13<00:01, 86.27it/s] 85%|████████▍ | 797/938 [00:13<00:01, 84.56it/s] 86%|████████▌ | 806/938 [00:13<00:01, 79.12it/s] 87%|████████▋ | 815/938 [00:13<00:01, 80.43it/s] 88%|████████▊ | 824/938 [00:13<00:01, 81.81it/s] 89%|████████▉ | 834/938 [00:14<00:01, 84.70it/s] 90%|████████▉ | 843/938 [00:14<00:01, 83.54it/s] 91%|█████████ | 852/938 [00:14<00:01, 80.16it/s] 92%|█████████▏| 862/938 [00:14<00:00, 83.58it/s] 93%|█████████▎| 872/938 [00:14<00:00, 85.91it/s] 94%|█████████▍| 881/938 [00:14<00:00, 84.61it/s] 95%|█████████▍| 890/938 [00:14<00:00, 81.23it/s] 96%|█████████▌| 899/938 [00:14<00:00, 78.19it/s] 97%|█████████▋| 909/938 [00:14<00:00, 81.61it/s] 98%|█████████▊| 918/938 [00:15<00:00, 83.81it/s] 99%|█████████▉| 927/938 [00:15<00:00, 79.46it/s]100%|█████████▉| 936/938 [00:15<00:00, 78.38it/s]100%|██████████| 938/938 [00:15<00:00, 60.45it/s]
Train Epoch: 1 	Loss: 0.880690 
Moments Accountant gives: (ε = 24.08, δ = 1e-05) for α = 1.60
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.44it/s] 20%|██        | 2/10 [00:00<00:03,  2.52it/s] 30%|███       | 3/10 [00:01<00:02,  3.31it/s] 40%|████      | 4/10 [00:01<00:01,  4.12it/s] 50%|█████     | 5/10 [00:01<00:01,  4.33it/s] 60%|██████    | 6/10 [00:01<00:00,  4.69it/s] 70%|███████   | 7/10 [00:01<00:00,  5.22it/s] 80%|████████  | 8/10 [00:01<00:00,  5.55it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.49it/s]100%|██████████| 10/10 [00:02<00:00,  6.22it/s]100%|██████████| 10/10 [00:02<00:00,  4.21it/s]

Test set: Average loss: 0.0004, Accuracy: 8845/10000 (88.45%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<04:45,  3.28it/s]  1%|          | 11/938 [00:00<00:27, 33.43it/s]  2%|▏         | 20/938 [00:00<00:18, 49.89it/s]  3%|▎         | 29/938 [00:00<00:14, 61.71it/s]  4%|▍         | 37/938 [00:00<00:13, 66.83it/s]  5%|▍         | 45/938 [00:00<00:13, 68.12it/s]  6%|▌         | 53/938 [00:00<00:12, 70.22it/s]  7%|▋         | 62/938 [00:01<00:11, 74.94it/s]  8%|▊         | 71/938 [00:01<00:11, 78.39it/s]  9%|▊         | 80/938 [00:01<00:11, 76.16it/s]  9%|▉         | 88/938 [00:01<00:11, 73.11it/s] 10%|█         | 97/938 [00:01<00:11, 75.41it/s] 11%|█▏        | 106/938 [00:01<00:10, 77.94it/s] 12%|█▏        | 115/938 [00:01<00:10, 80.78it/s] 13%|█▎        | 124/938 [00:01<00:09, 82.90it/s] 14%|█▍        | 133/938 [00:01<00:10, 77.98it/s] 15%|█▌        | 141/938 [00:02<00:10, 75.47it/s] 16%|█▌        | 149/938 [00:02<00:10, 76.43it/s] 17%|█▋        | 157/938 [00:02<00:10, 76.36it/s] 18%|█▊        | 165/938 [00:02<00:10, 74.54it/s] 18%|█▊        | 173/938 [00:02<00:10, 72.86it/s] 19%|█▉        | 181/938 [00:02<00:10, 70.99it/s] 20%|██        | 190/938 [00:02<00:09, 75.62it/s] 21%|██        | 199/938 [00:02<00:09, 78.73it/s] 22%|██▏       | 208/938 [00:02<00:09, 79.91it/s] 23%|██▎       | 217/938 [00:03<00:09, 75.05it/s] 24%|██▍       | 225/938 [00:03<00:09, 71.43it/s] 25%|██▍       | 234/938 [00:03<00:09, 73.01it/s] 26%|██▌       | 243/938 [00:03<00:09, 75.59it/s] 27%|██▋       | 252/938 [00:03<00:08, 78.10it/s] 28%|██▊       | 260/938 [00:03<00:08, 77.88it/s] 29%|██▊       | 268/938 [00:03<00:08, 74.99it/s] 29%|██▉       | 276/938 [00:03<00:09, 73.28it/s] 30%|███       | 285/938 [00:03<00:08, 75.30it/s] 31%|███       | 293/938 [00:04<00:08, 75.24it/s] 32%|███▏      | 302/938 [00:04<00:08, 76.41it/s] 33%|███▎      | 310/938 [00:04<00:08, 74.10it/s] 34%|███▍      | 318/938 [00:04<00:08, 72.75it/s] 35%|███▍      | 327/938 [00:04<00:08, 76.31it/s] 36%|███▌      | 335/938 [00:04<00:07, 77.16it/s] 37%|███▋      | 344/938 [00:04<00:07, 77.56it/s] 38%|███▊      | 352/938 [00:04<00:07, 74.90it/s] 38%|███▊      | 360/938 [00:04<00:07, 72.96it/s] 39%|███▉      | 369/938 [00:05<00:07, 75.61it/s] 40%|████      | 377/938 [00:05<00:07, 74.51it/s] 41%|████      | 385/938 [00:05<00:07, 70.97it/s] 42%|████▏     | 393/938 [00:05<00:08, 65.83it/s] 43%|████▎     | 400/938 [00:05<00:08, 66.62it/s] 44%|████▎     | 409/938 [00:05<00:07, 71.17it/s] 45%|████▍     | 418/938 [00:05<00:07, 74.05it/s] 46%|████▌     | 427/938 [00:05<00:06, 77.12it/s] 46%|████▋     | 435/938 [00:06<00:06, 74.56it/s] 47%|████▋     | 443/938 [00:06<00:06, 72.04it/s] 48%|████▊     | 452/938 [00:06<00:06, 74.96it/s] 49%|████▉     | 460/938 [00:06<00:06, 75.37it/s] 50%|████▉     | 468/938 [00:06<00:06, 76.08it/s] 51%|█████     | 476/938 [00:06<00:06, 71.53it/s] 52%|█████▏    | 484/938 [00:06<00:06, 71.17it/s] 53%|█████▎    | 493/938 [00:06<00:05, 74.21it/s] 54%|█████▎    | 502/938 [00:06<00:05, 77.53it/s] 54%|█████▍    | 510/938 [00:07<00:05, 77.54it/s] 55%|█████▌    | 519/938 [00:07<00:05, 78.50it/s] 56%|█████▋    | 528/938 [00:07<00:05, 80.42it/s] 57%|█████▋    | 537/938 [00:07<00:04, 80.87it/s] 58%|█████▊    | 546/938 [00:07<00:04, 80.26it/s] 59%|█████▉    | 555/938 [00:07<00:05, 76.33it/s] 60%|██████    | 563/938 [00:07<00:04, 76.75it/s] 61%|██████    | 571/938 [00:07<00:04, 74.41it/s] 62%|██████▏   | 579/938 [00:07<00:04, 75.07it/s] 63%|██████▎   | 587/938 [00:08<00:04, 71.69it/s] 63%|██████▎   | 595/938 [00:08<00:04, 69.33it/s] 64%|██████▍   | 604/938 [00:08<00:04, 73.38it/s] 65%|██████▌   | 612/938 [00:08<00:04, 74.91it/s] 66%|██████▌   | 620/938 [00:08<00:04, 74.86it/s] 67%|██████▋   | 628/938 [00:08<00:04, 75.84it/s] 68%|██████▊   | 636/938 [00:08<00:04, 71.73it/s] 69%|██████▊   | 644/938 [00:08<00:04, 71.45it/s] 70%|██████▉   | 653/938 [00:08<00:03, 75.90it/s] 71%|███████   | 662/938 [00:09<00:03, 77.23it/s] 71%|███████▏  | 670/938 [00:09<00:03, 70.68it/s] 72%|███████▏  | 678/938 [00:09<00:03, 69.64it/s] 73%|███████▎  | 686/938 [00:09<00:03, 68.49it/s] 74%|███████▍  | 694/938 [00:09<00:03, 69.45it/s] 75%|███████▍  | 701/938 [00:09<00:03, 69.00it/s] 76%|███████▌  | 710/938 [00:09<00:03, 73.05it/s] 77%|███████▋  | 719/938 [00:09<00:02, 75.57it/s] 78%|███████▊  | 727/938 [00:09<00:02, 76.47it/s] 78%|███████▊  | 736/938 [00:10<00:02, 78.69it/s] 79%|███████▉  | 745/938 [00:10<00:02, 79.53it/s] 80%|████████  | 753/938 [00:10<00:02, 78.48it/s] 81%|████████  | 762/938 [00:10<00:02, 77.67it/s] 82%|████████▏ | 770/938 [00:10<00:02, 74.61it/s] 83%|████████▎ | 779/938 [00:10<00:02, 76.44it/s] 84%|████████▍ | 788/938 [00:10<00:01, 78.05it/s] 85%|████████▍ | 797/938 [00:10<00:01, 79.32it/s] 86%|████████▌ | 805/938 [00:10<00:01, 75.55it/s] 87%|████████▋ | 813/938 [00:11<00:01, 71.56it/s] 88%|████████▊ | 822/938 [00:11<00:01, 75.83it/s] 89%|████████▊ | 831/938 [00:11<00:01, 77.59it/s] 90%|████████▉ | 840/938 [00:11<00:01, 78.88it/s] 90%|█████████ | 848/938 [00:11<00:01, 74.42it/s] 91%|█████████▏| 857/938 [00:11<00:01, 78.11it/s] 92%|█████████▏| 865/938 [00:11<00:00, 78.35it/s] 93%|█████████▎| 874/938 [00:11<00:00, 80.21it/s] 94%|█████████▍| 883/938 [00:11<00:00, 78.77it/s] 95%|█████████▍| 891/938 [00:12<00:00, 76.99it/s] 96%|█████████▌| 899/938 [00:12<00:00, 77.11it/s] 97%|█████████▋| 908/938 [00:12<00:00, 78.31it/s] 98%|█████████▊| 917/938 [00:12<00:00, 79.53it/s] 99%|█████████▊| 926/938 [00:12<00:00, 80.02it/s]100%|█████████▉| 935/938 [00:12<00:00, 81.03it/s]100%|██████████| 938/938 [00:12<00:00, 73.25it/s]
Train Epoch: 2 	Loss: 0.437721 
Moments Accountant gives: (ε = 28.98, δ = 1e-05) for α = 1.60
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.65it/s] 20%|██        | 2/10 [00:00<00:02,  2.98it/s] 30%|███       | 3/10 [00:00<00:01,  3.85it/s] 40%|████      | 4/10 [00:01<00:01,  4.62it/s] 50%|█████     | 5/10 [00:01<00:00,  5.16it/s] 60%|██████    | 6/10 [00:01<00:00,  5.53it/s] 70%|███████   | 7/10 [00:01<00:00,  5.82it/s] 80%|████████  | 8/10 [00:01<00:00,  6.10it/s] 90%|█████████ | 9/10 [00:01<00:00,  6.25it/s]100%|██████████| 10/10 [00:01<00:00,  6.83it/s]100%|██████████| 10/10 [00:02<00:00,  4.71it/s]

Test set: Average loss: 0.0004, Accuracy: 9199/10000 (91.99%)

Training membership inference attack model
Base model accuracy:  0.9199
Random forest model attack results: 
train acc: 0.9997166666666667
test acc: 0.5006999999999999
total acc: 0.9284285714285714
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:10,  1.17s/it] 20%|██        | 2/10 [00:01<00:04,  1.69it/s] 30%|███       | 3/10 [00:01<00:02,  2.39it/s] 40%|████      | 4/10 [00:01<00:02,  2.98it/s] 50%|█████     | 5/10 [00:01<00:01,  3.44it/s] 60%|██████    | 6/10 [00:02<00:01,  3.76it/s] 70%|███████   | 7/10 [00:02<00:00,  3.72it/s] 80%|████████  | 8/10 [00:02<00:00,  4.03it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.33it/s]100%|██████████| 10/10 [00:03<00:00,  4.59it/s]100%|██████████| 10/10 [00:03<00:00,  3.02it/s]

Test set: Average loss: 0.0004, Accuracy: 9199/10000 (91.99%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:02<35:57,  2.30s/it]  1%|          | 8/938 [00:02<03:27,  4.49it/s]  2%|▏         | 15/938 [00:02<01:37,  9.47it/s]  2%|▏         | 21/938 [00:02<01:04, 14.30it/s]  3%|▎         | 27/938 [00:02<00:47, 19.22it/s]  4%|▎         | 33/938 [00:02<00:37, 24.18it/s]  4%|▍         | 39/938 [00:02<00:29, 30.09it/s]  5%|▍         | 46/938 [00:03<00:23, 37.34it/s]  6%|▌         | 54/938 [00:03<00:19, 45.76it/s]  7%|▋         | 62/938 [00:03<00:16, 52.92it/s]  7%|▋         | 69/938 [00:03<00:16, 53.26it/s]  8%|▊         | 76/938 [00:03<00:15, 54.97it/s]  9%|▉         | 84/938 [00:03<00:14, 59.89it/s] 10%|▉         | 93/938 [00:03<00:12, 66.78it/s] 11%|█         | 102/938 [00:03<00:11, 71.79it/s] 12%|█▏        | 111/938 [00:03<00:11, 72.72it/s] 13%|█▎        | 119/938 [00:04<00:11, 70.99it/s] 14%|█▎        | 127/938 [00:04<00:11, 69.53it/s] 14%|█▍        | 136/938 [00:04<00:10, 73.19it/s] 15%|█▌        | 144/938 [00:04<00:10, 74.21it/s] 16%|█▌        | 152/938 [00:04<00:10, 74.23it/s] 17%|█▋        | 160/938 [00:04<00:11, 70.51it/s] 18%|█▊        | 168/938 [00:04<00:11, 67.50it/s] 19%|█▉        | 177/938 [00:04<00:10, 71.75it/s] 20%|█▉        | 185/938 [00:05<00:10, 73.70it/s] 21%|██        | 193/938 [00:05<00:10, 72.98it/s] 21%|██▏       | 201/938 [00:05<00:10, 70.55it/s] 22%|██▏       | 209/938 [00:05<00:10, 71.69it/s] 23%|██▎       | 218/938 [00:05<00:09, 75.38it/s] 24%|██▍       | 226/938 [00:05<00:09, 75.48it/s] 25%|██▍       | 234/938 [00:05<00:10, 69.34it/s] 26%|██▌       | 242/938 [00:05<00:10, 67.43it/s] 27%|██▋       | 251/938 [00:05<00:09, 71.64it/s] 28%|██▊       | 259/938 [00:06<00:09, 73.25it/s] 28%|██▊       | 267/938 [00:06<00:08, 74.64it/s] 29%|██▉       | 275/938 [00:06<00:10, 64.39it/s] 30%|███       | 282/938 [00:06<00:11, 56.33it/s] 31%|███       | 288/938 [00:06<00:12, 53.68it/s] 31%|███▏      | 294/938 [00:06<00:12, 50.41it/s] 32%|███▏      | 300/938 [00:06<00:13, 48.81it/s] 33%|███▎      | 305/938 [00:06<00:13, 47.91it/s] 33%|███▎      | 310/938 [00:07<00:13, 47.97it/s] 34%|███▎      | 315/938 [00:07<00:12, 48.40it/s] 34%|███▍      | 320/938 [00:07<00:13, 47.45it/s] 35%|███▍      | 325/938 [00:07<00:13, 45.85it/s] 35%|███▌      | 330/938 [00:07<00:12, 46.89it/s] 36%|███▌      | 336/938 [00:07<00:12, 48.65it/s] 36%|███▋      | 341/938 [00:07<00:12, 46.28it/s] 37%|███▋      | 346/938 [00:07<00:12, 46.98it/s] 38%|███▊      | 352/938 [00:07<00:11, 48.95it/s] 38%|███▊      | 357/938 [00:08<00:12, 45.46it/s] 39%|███▊      | 363/938 [00:08<00:12, 47.90it/s] 39%|███▉      | 369/938 [00:08<00:11, 49.46it/s] 40%|███▉      | 374/938 [00:08<00:11, 49.17it/s] 41%|████      | 381/938 [00:08<00:10, 53.61it/s] 41%|████▏     | 387/938 [00:08<00:10, 52.02it/s] 42%|████▏     | 393/938 [00:08<00:10, 52.94it/s] 43%|████▎     | 400/938 [00:08<00:09, 55.95it/s] 43%|████▎     | 408/938 [00:08<00:08, 61.44it/s] 44%|████▍     | 415/938 [00:09<00:08, 59.35it/s] 45%|████▍     | 422/938 [00:09<00:08, 60.47it/s] 46%|████▌     | 429/938 [00:09<00:08, 61.08it/s] 46%|████▋     | 436/938 [00:09<00:09, 53.11it/s] 47%|████▋     | 442/938 [00:09<00:10, 49.38it/s] 48%|████▊     | 448/938 [00:09<00:11, 43.15it/s] 48%|████▊     | 453/938 [00:09<00:10, 44.54it/s] 49%|████▉     | 458/938 [00:10<00:11, 42.30it/s] 49%|████▉     | 463/938 [00:10<00:11, 40.82it/s] 50%|████▉     | 468/938 [00:10<00:11, 42.66it/s] 51%|█████     | 474/938 [00:10<00:10, 45.09it/s] 51%|█████     | 479/938 [00:10<00:09, 46.26it/s] 52%|█████▏    | 485/938 [00:10<00:09, 47.61it/s] 52%|█████▏    | 490/938 [00:10<00:09, 45.18it/s] 53%|█████▎    | 495/938 [00:10<00:10, 42.93it/s] 53%|█████▎    | 500/938 [00:11<00:10, 41.86it/s] 54%|█████▍    | 505/938 [00:11<00:10, 41.80it/s] 54%|█████▍    | 510/938 [00:11<00:10, 42.13it/s] 55%|█████▍    | 515/938 [00:11<00:10, 39.78it/s] 55%|█████▌    | 520/938 [00:11<00:11, 36.51it/s] 56%|█████▌    | 524/938 [00:11<00:12, 34.10it/s] 56%|█████▋    | 528/938 [00:11<00:12, 31.61it/s] 57%|█████▋    | 532/938 [00:11<00:12, 32.92it/s] 57%|█████▋    | 536/938 [00:12<00:12, 32.18it/s] 58%|█████▊    | 540/938 [00:12<00:13, 30.10it/s] 58%|█████▊    | 545/938 [00:12<00:11, 33.63it/s] 59%|█████▊    | 550/938 [00:12<00:10, 36.65it/s] 59%|█████▉    | 554/938 [00:12<00:10, 36.23it/s] 59%|█████▉    | 558/938 [00:12<00:10, 37.00it/s] 60%|█████▉    | 562/938 [00:12<00:10, 36.17it/s] 60%|██████    | 566/938 [00:12<00:10, 36.26it/s] 61%|██████    | 570/938 [00:13<00:10, 35.78it/s] 61%|██████    | 574/938 [00:13<00:10, 35.09it/s] 62%|██████▏   | 578/938 [00:13<00:10, 33.15it/s] 62%|██████▏   | 582/938 [00:13<00:10, 32.51it/s] 63%|██████▎   | 587/938 [00:13<00:09, 36.10it/s] 63%|██████▎   | 592/938 [00:13<00:09, 36.87it/s] 64%|██████▎   | 596/938 [00:13<00:10, 34.12it/s] 64%|██████▍   | 600/938 [00:13<00:09, 34.03it/s] 64%|██████▍   | 605/938 [00:14<00:09, 36.57it/s] 65%|██████▍   | 609/938 [00:14<00:08, 37.13it/s] 65%|██████▌   | 613/938 [00:14<00:08, 37.43it/s] 66%|██████▌   | 617/938 [00:14<00:09, 35.39it/s] 66%|██████▋   | 622/938 [00:14<00:08, 38.26it/s] 67%|██████▋   | 626/938 [00:14<00:08, 38.19it/s] 67%|██████▋   | 630/938 [00:14<00:07, 38.50it/s] 68%|██████▊   | 634/938 [00:14<00:07, 38.02it/s] 68%|██████▊   | 639/938 [00:14<00:07, 40.89it/s] 69%|██████▊   | 644/938 [00:15<00:06, 43.06it/s] 69%|██████▉   | 649/938 [00:15<00:07, 41.21it/s] 70%|██████▉   | 654/938 [00:15<00:07, 40.50it/s] 70%|███████   | 660/938 [00:15<00:06, 43.75it/s] 71%|███████   | 666/938 [00:15<00:05, 46.25it/s] 72%|███████▏  | 672/938 [00:15<00:05, 47.40it/s] 72%|███████▏  | 677/938 [00:15<00:05, 47.51it/s] 73%|███████▎  | 683/938 [00:15<00:05, 48.82it/s] 73%|███████▎  | 689/938 [00:15<00:04, 49.91it/s] 74%|███████▍  | 696/938 [00:16<00:04, 54.17it/s] 75%|███████▌  | 704/938 [00:16<00:03, 61.03it/s] 76%|███████▌  | 711/938 [00:16<00:03, 61.47it/s] 77%|███████▋  | 718/938 [00:16<00:03, 63.27it/s] 77%|███████▋  | 725/938 [00:16<00:03, 60.73it/s] 78%|███████▊  | 732/938 [00:16<00:03, 55.93it/s] 79%|███████▊  | 738/938 [00:16<00:03, 53.99it/s] 79%|███████▉  | 744/938 [00:16<00:03, 53.05it/s] 80%|████████  | 752/938 [00:17<00:03, 58.45it/s] 81%|████████  | 759/938 [00:17<00:02, 59.91it/s] 82%|████████▏ | 766/938 [00:17<00:03, 54.38it/s] 82%|████████▏ | 772/938 [00:17<00:03, 50.94it/s] 83%|████████▎ | 778/938 [00:17<00:03, 50.76it/s] 84%|████████▎ | 784/938 [00:17<00:03, 47.98it/s] 84%|████████▍ | 790/938 [00:17<00:02, 49.56it/s] 85%|████████▍ | 797/938 [00:17<00:02, 53.15it/s] 86%|████████▌ | 805/938 [00:18<00:02, 58.82it/s] 86%|████████▋ | 811/938 [00:18<00:02, 57.51it/s] 87%|████████▋ | 817/938 [00:18<00:02, 54.72it/s] 88%|████████▊ | 823/938 [00:18<00:02, 53.60it/s] 88%|████████▊ | 829/938 [00:18<00:02, 54.21it/s] 89%|████████▉ | 835/938 [00:18<00:01, 54.44it/s] 90%|████████▉ | 843/938 [00:18<00:01, 59.52it/s] 91%|█████████ | 850/938 [00:18<00:01, 60.64it/s] 91%|█████████▏| 858/938 [00:18<00:01, 64.71it/s] 92%|█████████▏| 867/938 [00:19<00:00, 71.62it/s] 93%|█████████▎| 875/938 [00:19<00:00, 71.23it/s] 94%|█████████▍| 883/938 [00:19<00:00, 65.33it/s] 95%|█████████▍| 890/938 [00:19<00:00, 60.75it/s] 96%|█████████▌| 897/938 [00:19<00:00, 61.18it/s] 96%|█████████▋| 905/938 [00:19<00:00, 63.57it/s] 97%|█████████▋| 914/938 [00:19<00:00, 68.51it/s] 98%|█████████▊| 921/938 [00:19<00:00, 65.30it/s] 99%|█████████▉| 928/938 [00:19<00:00, 66.17it/s]100%|█████████▉| 935/938 [00:20<00:00, 62.41it/s]100%|██████████| 938/938 [00:21<00:00, 42.67it/s]
Train Epoch: 1 	Loss: 1.024872 
Moments Accountant gives: (ε = 10.19, δ = 1e-05) for α = 2.30
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:09,  1.09s/it] 20%|██        | 2/10 [00:01<00:04,  1.62it/s] 30%|███       | 3/10 [00:01<00:03,  2.17it/s] 40%|████      | 4/10 [00:01<00:02,  2.66it/s] 50%|█████     | 5/10 [00:02<00:01,  3.19it/s] 60%|██████    | 6/10 [00:02<00:01,  3.33it/s] 70%|███████   | 7/10 [00:02<00:00,  3.12it/s] 80%|████████  | 8/10 [00:03<00:00,  3.26it/s] 90%|█████████ | 9/10 [00:03<00:00,  3.49it/s]100%|██████████| 10/10 [00:03<00:00,  3.75it/s]100%|██████████| 10/10 [00:03<00:00,  2.69it/s]

Test set: Average loss: 0.0006, Accuracy: 8428/10000 (84.28%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<04:48,  3.25it/s]  1%|          | 5/938 [00:00<01:03, 14.71it/s]  1%|          | 11/938 [00:00<00:33, 27.53it/s]  2%|▏         | 17/938 [00:00<00:24, 36.95it/s]  3%|▎         | 25/938 [00:00<00:18, 48.71it/s]  4%|▎         | 33/938 [00:00<00:15, 56.94it/s]  4%|▍         | 40/938 [00:00<00:14, 60.71it/s]  5%|▌         | 47/938 [00:01<00:14, 62.77it/s]  6%|▌         | 54/938 [00:01<00:15, 58.17it/s]  7%|▋         | 61/938 [00:01<00:16, 53.31it/s]  7%|▋         | 67/938 [00:01<00:16, 52.83it/s]  8%|▊         | 76/938 [00:01<00:14, 60.92it/s]  9%|▉         | 85/938 [00:01<00:12, 66.52it/s] 10%|█         | 94/938 [00:01<00:11, 70.83it/s] 11%|█         | 102/938 [00:01<00:12, 67.25it/s] 12%|█▏        | 109/938 [00:02<00:12, 64.81it/s] 12%|█▏        | 116/938 [00:02<00:13, 61.98it/s] 13%|█▎        | 123/938 [00:02<00:12, 63.18it/s] 14%|█▍        | 130/938 [00:02<00:12, 63.06it/s] 15%|█▍        | 137/938 [00:02<00:13, 58.93it/s] 15%|█▌        | 145/938 [00:02<00:12, 63.87it/s] 16%|█▌        | 152/938 [00:02<00:12, 62.19it/s] 17%|█▋        | 159/938 [00:02<00:12, 62.29it/s] 18%|█▊        | 166/938 [00:02<00:12, 61.40it/s] 19%|█▊        | 174/938 [00:03<00:11, 64.63it/s] 20%|█▉        | 183/938 [00:03<00:10, 69.61it/s] 20%|██        | 191/938 [00:03<00:10, 71.93it/s] 21%|██        | 199/938 [00:03<00:10, 71.50it/s] 22%|██▏       | 207/938 [00:03<00:11, 63.48it/s] 23%|██▎       | 214/938 [00:03<00:11, 64.57it/s] 24%|██▎       | 221/938 [00:03<00:10, 65.43it/s] 24%|██▍       | 228/938 [00:03<00:10, 65.75it/s] 25%|██▌       | 236/938 [00:03<00:10, 67.85it/s] 26%|██▌       | 243/938 [00:04<00:10, 65.34it/s] 27%|██▋       | 250/938 [00:04<00:11, 60.22it/s] 27%|██▋       | 257/938 [00:04<00:11, 58.28it/s] 28%|██▊       | 266/938 [00:04<00:10, 64.52it/s] 29%|██▉       | 274/938 [00:04<00:09, 67.62it/s] 30%|███       | 282/938 [00:04<00:09, 69.78it/s] 31%|███       | 290/938 [00:04<00:09, 65.77it/s] 32%|███▏      | 297/938 [00:04<00:10, 62.37it/s] 32%|███▏      | 304/938 [00:05<00:10, 61.26it/s] 33%|███▎      | 312/938 [00:05<00:09, 65.39it/s] 34%|███▍      | 320/938 [00:05<00:09, 67.69it/s] 35%|███▍      | 328/938 [00:05<00:08, 70.82it/s] 36%|███▌      | 336/938 [00:05<00:08, 67.68it/s] 37%|███▋      | 343/938 [00:05<00:08, 66.15it/s] 37%|███▋      | 351/938 [00:05<00:08, 67.94it/s] 38%|███▊      | 360/938 [00:05<00:07, 72.53it/s] 39%|███▉      | 369/938 [00:05<00:07, 75.66it/s] 40%|████      | 378/938 [00:06<00:07, 77.20it/s] 41%|████      | 386/938 [00:06<00:07, 73.88it/s] 42%|████▏     | 395/938 [00:06<00:07, 77.46it/s] 43%|████▎     | 403/938 [00:06<00:07, 72.22it/s] 44%|████▍     | 411/938 [00:06<00:07, 67.91it/s] 45%|████▍     | 418/938 [00:06<00:07, 65.28it/s] 45%|████▌     | 425/938 [00:06<00:08, 62.87it/s] 46%|████▌     | 432/938 [00:06<00:08, 61.31it/s] 47%|████▋     | 439/938 [00:07<00:08, 61.30it/s] 48%|████▊     | 446/938 [00:07<00:07, 62.20it/s] 48%|████▊     | 453/938 [00:07<00:07, 60.69it/s] 49%|████▉     | 460/938 [00:07<00:07, 61.53it/s] 50%|████▉     | 467/938 [00:07<00:07, 63.73it/s] 51%|█████     | 476/938 [00:07<00:06, 68.74it/s] 52%|█████▏    | 485/938 [00:07<00:06, 73.35it/s] 53%|█████▎    | 493/938 [00:07<00:06, 71.16it/s] 54%|█████▎    | 502/938 [00:07<00:05, 74.64it/s] 54%|█████▍    | 511/938 [00:08<00:05, 76.40it/s] 55%|█████▌    | 519/938 [00:08<00:05, 73.90it/s] 56%|█████▌    | 527/938 [00:08<00:05, 72.32it/s] 57%|█████▋    | 536/938 [00:08<00:05, 75.85it/s] 58%|█████▊    | 545/938 [00:08<00:05, 78.43it/s] 59%|█████▉    | 553/938 [00:08<00:05, 73.43it/s] 60%|█████▉    | 562/938 [00:08<00:04, 76.82it/s] 61%|██████    | 571/938 [00:08<00:04, 79.40it/s] 62%|██████▏   | 580/938 [00:08<00:04, 74.86it/s] 63%|██████▎   | 588/938 [00:09<00:04, 71.89it/s] 64%|██████▎   | 596/938 [00:09<00:04, 73.68it/s] 64%|██████▍   | 604/938 [00:09<00:04, 71.29it/s] 65%|██████▌   | 612/938 [00:09<00:05, 63.38it/s] 66%|██████▌   | 620/938 [00:09<00:04, 66.25it/s] 67%|██████▋   | 629/938 [00:09<00:04, 70.42it/s] 68%|██████▊   | 637/938 [00:09<00:04, 65.02it/s] 69%|██████▊   | 644/938 [00:09<00:04, 60.17it/s] 69%|██████▉   | 651/938 [00:10<00:04, 58.17it/s] 70%|███████   | 660/938 [00:10<00:04, 64.05it/s] 71%|███████   | 667/938 [00:10<00:04, 64.83it/s] 72%|███████▏  | 676/938 [00:10<00:03, 70.61it/s] 73%|███████▎  | 685/938 [00:10<00:03, 73.45it/s] 74%|███████▍  | 693/938 [00:10<00:03, 73.79it/s] 75%|███████▍  | 701/938 [00:10<00:03, 74.43it/s] 76%|███████▌  | 710/938 [00:10<00:02, 77.31it/s] 77%|███████▋  | 719/938 [00:10<00:02, 79.40it/s] 78%|███████▊  | 727/938 [00:11<00:02, 76.00it/s] 78%|███████▊  | 736/938 [00:11<00:02, 77.89it/s] 79%|███████▉  | 744/938 [00:11<00:02, 78.36it/s] 80%|████████  | 753/938 [00:11<00:02, 78.02it/s] 81%|████████  | 761/938 [00:11<00:02, 77.89it/s] 82%|████████▏ | 770/938 [00:11<00:02, 80.75it/s] 83%|████████▎ | 779/938 [00:11<00:02, 77.72it/s] 84%|████████▍ | 787/938 [00:11<00:02, 74.83it/s] 85%|████████▍ | 796/938 [00:11<00:01, 78.18it/s] 86%|████████▌ | 805/938 [00:12<00:01, 79.31it/s] 87%|████████▋ | 814/938 [00:12<00:01, 80.65it/s] 88%|████████▊ | 823/938 [00:12<00:01, 79.78it/s] 89%|████████▊ | 832/938 [00:12<00:01, 79.76it/s] 90%|████████▉ | 840/938 [00:12<00:01, 78.26it/s] 90%|█████████ | 848/938 [00:12<00:01, 76.59it/s] 91%|█████████▏| 857/938 [00:12<00:01, 78.32it/s] 92%|█████████▏| 866/938 [00:12<00:00, 79.64it/s] 93%|█████████▎| 874/938 [00:12<00:00, 74.99it/s] 94%|█████████▍| 882/938 [00:13<00:00, 74.37it/s] 95%|█████████▍| 890/938 [00:13<00:00, 74.45it/s] 96%|█████████▌| 898/938 [00:13<00:00, 63.73it/s] 96%|█████████▋| 905/938 [00:13<00:00, 58.32it/s] 97%|█████████▋| 912/938 [00:13<00:00, 59.34it/s] 98%|█████████▊| 920/938 [00:13<00:00, 63.29it/s] 99%|█████████▉| 928/938 [00:13<00:00, 66.86it/s]100%|█████████▉| 935/938 [00:13<00:00, 67.18it/s]100%|██████████| 938/938 [00:14<00:00, 66.42it/s]
Train Epoch: 2 	Loss: 0.548205 
Moments Accountant gives: (ε = 11.50, δ = 1e-05) for α = 2.20
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.31it/s] 20%|██        | 2/10 [00:00<00:03,  2.33it/s] 30%|███       | 3/10 [00:01<00:02,  3.03it/s] 40%|████      | 4/10 [00:01<00:01,  3.59it/s] 50%|█████     | 5/10 [00:01<00:01,  3.91it/s] 60%|██████    | 6/10 [00:01<00:00,  4.31it/s] 70%|███████   | 7/10 [00:01<00:00,  4.37it/s] 80%|████████  | 8/10 [00:02<00:00,  4.57it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.60it/s]100%|██████████| 10/10 [00:02<00:00,  4.98it/s]100%|██████████| 10/10 [00:02<00:00,  3.57it/s]

Test set: Average loss: 0.0005, Accuracy: 8978/10000 (89.78%)

Training membership inference attack model
Base model accuracy:  0.8978
Random forest model attack results: 
train acc: 0.9996666666666667
test acc: 0.5011
total acc: 0.9284428571428571
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.37it/s] 20%|██        | 2/10 [00:00<00:03,  2.40it/s] 30%|███       | 3/10 [00:01<00:02,  3.37it/s] 40%|████      | 4/10 [00:01<00:01,  3.94it/s] 50%|█████     | 5/10 [00:01<00:01,  4.59it/s] 60%|██████    | 6/10 [00:01<00:00,  5.05it/s] 70%|███████   | 7/10 [00:01<00:00,  5.39it/s] 80%|████████  | 8/10 [00:01<00:00,  5.67it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.65it/s]100%|██████████| 10/10 [00:02<00:00,  6.28it/s]100%|██████████| 10/10 [00:02<00:00,  4.24it/s]

Test set: Average loss: 0.0005, Accuracy: 8978/10000 (89.78%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:03<53:08,  3.40s/it]  1%|          | 6/938 [00:03<06:48,  2.28it/s]  1%|          | 10/938 [00:03<03:35,  4.31it/s]  2%|▏         | 15/938 [00:03<02:02,  7.52it/s]  2%|▏         | 20/938 [00:03<01:20, 11.37it/s]  3%|▎         | 25/938 [00:03<00:59, 15.34it/s]  3%|▎         | 31/938 [00:04<00:43, 20.95it/s]  4%|▍         | 37/938 [00:04<00:33, 27.21it/s]  5%|▍         | 43/938 [00:04<00:26, 33.27it/s]  5%|▌         | 51/938 [00:04<00:20, 42.96it/s]  6%|▋         | 59/938 [00:04<00:17, 51.35it/s]  7%|▋         | 68/938 [00:04<00:14, 59.36it/s]  8%|▊         | 76/938 [00:04<00:13, 64.11it/s]  9%|▉         | 84/938 [00:04<00:13, 64.58it/s] 10%|▉         | 92/938 [00:04<00:13, 63.44it/s] 11%|█         | 100/938 [00:05<00:12, 66.01it/s] 12%|█▏        | 109/938 [00:05<00:11, 70.50it/s] 12%|█▏        | 117/938 [00:05<00:11, 72.68it/s] 13%|█▎        | 125/938 [00:05<00:11, 71.29it/s] 14%|█▍        | 133/938 [00:05<00:12, 62.90it/s] 15%|█▍        | 140/938 [00:05<00:13, 60.61it/s] 16%|█▌        | 148/938 [00:05<00:12, 63.61it/s] 17%|█▋        | 155/938 [00:05<00:12, 64.37it/s] 17%|█▋        | 162/938 [00:06<00:12, 60.31it/s] 18%|█▊        | 169/938 [00:06<00:12, 61.15it/s] 19%|█▉        | 177/938 [00:06<00:11, 64.97it/s] 20%|█▉        | 184/938 [00:06<00:12, 60.96it/s] 20%|██        | 191/938 [00:06<00:12, 59.17it/s] 21%|██        | 197/938 [00:06<00:12, 59.01it/s] 22%|██▏       | 203/938 [00:06<00:12, 57.83it/s] 23%|██▎       | 212/938 [00:06<00:11, 64.65it/s] 23%|██▎       | 220/938 [00:06<00:10, 67.92it/s] 24%|██▍       | 229/938 [00:07<00:09, 71.91it/s] 25%|██▌       | 237/938 [00:07<00:09, 72.93it/s] 26%|██▌       | 245/938 [00:07<00:09, 74.78it/s] 27%|██▋       | 254/938 [00:07<00:08, 77.42it/s] 28%|██▊       | 263/938 [00:07<00:08, 78.67it/s] 29%|██▉       | 272/938 [00:07<00:08, 79.81it/s] 30%|██▉       | 281/938 [00:07<00:08, 80.32it/s] 31%|███       | 290/938 [00:07<00:07, 81.24it/s] 32%|███▏      | 299/938 [00:07<00:08, 77.98it/s] 33%|███▎      | 308/938 [00:08<00:07, 79.21it/s] 34%|███▎      | 316/938 [00:08<00:07, 78.68it/s] 35%|███▍      | 325/938 [00:08<00:07, 79.14it/s] 36%|███▌      | 334/938 [00:08<00:07, 79.60it/s] 37%|███▋      | 343/938 [00:08<00:07, 79.92it/s] 37%|███▋      | 351/938 [00:08<00:07, 78.88it/s] 38%|███▊      | 359/938 [00:08<00:07, 77.77it/s] 39%|███▉      | 367/938 [00:08<00:07, 73.00it/s] 40%|███▉      | 375/938 [00:08<00:08, 69.05it/s] 41%|████      | 382/938 [00:09<00:08, 65.02it/s] 42%|████▏     | 390/938 [00:09<00:08, 67.09it/s] 43%|████▎     | 399/938 [00:09<00:07, 72.32it/s] 43%|████▎     | 407/938 [00:09<00:07, 71.43it/s] 44%|████▍     | 415/938 [00:09<00:07, 68.29it/s] 45%|████▍     | 422/938 [00:09<00:07, 65.84it/s] 46%|████▌     | 430/938 [00:09<00:07, 68.37it/s] 47%|████▋     | 438/938 [00:09<00:07, 69.46it/s] 47%|████▋     | 445/938 [00:09<00:07, 69.53it/s] 48%|████▊     | 452/938 [00:10<00:07, 64.58it/s] 49%|████▉     | 459/938 [00:10<00:07, 60.86it/s] 50%|████▉     | 468/938 [00:10<00:07, 66.24it/s] 51%|█████     | 477/938 [00:10<00:06, 72.31it/s] 52%|█████▏    | 486/938 [00:10<00:05, 76.21it/s] 53%|█████▎    | 495/938 [00:10<00:05, 77.97it/s] 54%|█████▎    | 503/938 [00:10<00:05, 73.30it/s] 54%|█████▍    | 511/938 [00:10<00:06, 69.93it/s] 55%|█████▌    | 519/938 [00:11<00:05, 71.84it/s] 56%|█████▋    | 528/938 [00:11<00:05, 75.00it/s] 57%|█████▋    | 537/938 [00:11<00:05, 78.30it/s] 58%|█████▊    | 545/938 [00:11<00:05, 73.60it/s] 59%|█████▉    | 553/938 [00:11<00:05, 69.65it/s] 60%|█████▉    | 561/938 [00:11<00:05, 68.84it/s] 61%|██████    | 568/938 [00:11<00:05, 66.99it/s] 61%|██████▏   | 575/938 [00:11<00:05, 65.49it/s] 62%|██████▏   | 583/938 [00:11<00:05, 66.96it/s] 63%|██████▎   | 590/938 [00:12<00:05, 67.11it/s] 64%|██████▍   | 598/938 [00:12<00:04, 69.08it/s] 65%|██████▍   | 606/938 [00:12<00:04, 70.33it/s] 66%|██████▌   | 616/938 [00:12<00:04, 76.51it/s] 67%|██████▋   | 624/938 [00:12<00:04, 74.55it/s] 67%|██████▋   | 632/938 [00:12<00:04, 72.91it/s] 68%|██████▊   | 641/938 [00:12<00:03, 75.88it/s] 69%|██████▉   | 650/938 [00:12<00:03, 78.67it/s] 70%|███████   | 659/938 [00:12<00:03, 79.74it/s] 71%|███████   | 667/938 [00:13<00:03, 79.32it/s] 72%|███████▏  | 675/938 [00:13<00:03, 75.87it/s] 73%|███████▎  | 683/938 [00:13<00:03, 71.70it/s] 74%|███████▍  | 693/938 [00:13<00:03, 78.34it/s] 75%|███████▍  | 702/938 [00:13<00:02, 79.31it/s] 76%|███████▌  | 711/938 [00:13<00:02, 79.84it/s] 77%|███████▋  | 720/938 [00:13<00:02, 74.23it/s] 78%|███████▊  | 728/938 [00:13<00:02, 74.46it/s] 79%|███████▊  | 737/938 [00:13<00:02, 76.77it/s] 80%|███████▉  | 746/938 [00:14<00:02, 79.15it/s] 80%|████████  | 755/938 [00:14<00:02, 80.49it/s] 81%|████████▏ | 764/938 [00:14<00:02, 75.68it/s] 82%|████████▏ | 772/938 [00:14<00:02, 73.66it/s] 83%|████████▎ | 781/938 [00:14<00:02, 76.30it/s] 84%|████████▍ | 790/938 [00:14<00:01, 79.33it/s] 85%|████████▌ | 799/938 [00:14<00:01, 81.02it/s] 86%|████████▌ | 808/938 [00:14<00:01, 78.23it/s] 87%|████████▋ | 816/938 [00:14<00:01, 75.00it/s] 88%|████████▊ | 824/938 [00:15<00:01, 72.08it/s] 89%|████████▊ | 832/938 [00:15<00:01, 69.95it/s] 90%|████████▉ | 840/938 [00:15<00:01, 72.14it/s] 90%|█████████ | 848/938 [00:15<00:01, 70.52it/s] 91%|█████████▏| 856/938 [00:15<00:01, 63.43it/s] 92%|█████████▏| 865/938 [00:15<00:01, 69.01it/s] 93%|█████████▎| 874/938 [00:15<00:00, 72.87it/s] 94%|█████████▍| 882/938 [00:15<00:00, 70.63it/s] 95%|█████████▍| 890/938 [00:16<00:00, 70.74it/s] 96%|█████████▌| 898/938 [00:16<00:00, 69.37it/s] 97%|█████████▋| 906/938 [00:16<00:00, 70.28it/s] 97%|█████████▋| 914/938 [00:16<00:00, 72.42it/s] 98%|█████████▊| 923/938 [00:16<00:00, 75.47it/s] 99%|█████████▉| 931/938 [00:16<00:00, 72.91it/s]100%|██████████| 938/938 [00:16<00:00, 55.53it/s]
Train Epoch: 1 	Loss: 0.873488 
Moments Accountant gives: (ε = 5.30, δ = 1e-05) for α = 3.40
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.52it/s] 20%|██        | 2/10 [00:00<00:02,  2.72it/s] 30%|███       | 3/10 [00:00<00:01,  3.69it/s] 40%|████      | 4/10 [00:01<00:01,  4.40it/s] 50%|█████     | 5/10 [00:01<00:01,  4.62it/s] 60%|██████    | 6/10 [00:01<00:00,  5.09it/s] 70%|███████   | 7/10 [00:01<00:00,  5.47it/s] 80%|████████  | 8/10 [00:01<00:00,  5.35it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.34it/s]100%|██████████| 10/10 [00:02<00:00,  5.95it/s]100%|██████████| 10/10 [00:02<00:00,  4.31it/s]

Test set: Average loss: 0.0005, Accuracy: 8883/10000 (88.83%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<04:54,  3.18it/s]  1%|          | 10/938 [00:00<00:31, 29.53it/s]  2%|▏         | 19/938 [00:00<00:19, 47.06it/s]  3%|▎         | 27/938 [00:00<00:16, 56.12it/s]  4%|▎         | 35/938 [00:00<00:14, 61.21it/s]  5%|▍         | 43/938 [00:00<00:14, 63.00it/s]  5%|▌         | 50/938 [00:00<00:13, 63.56it/s]  6%|▌         | 57/938 [00:01<00:15, 57.01it/s]  7%|▋         | 64/938 [00:01<00:15, 55.17it/s]  7%|▋         | 70/938 [00:01<00:16, 52.51it/s]  8%|▊         | 76/938 [00:01<00:17, 50.40it/s]  9%|▊         | 82/938 [00:01<00:17, 49.42it/s]  9%|▉         | 88/938 [00:01<00:17, 48.38it/s] 10%|▉         | 93/938 [00:01<00:17, 48.67it/s] 11%|█         | 100/938 [00:01<00:15, 54.22it/s] 12%|█▏        | 108/938 [00:02<00:13, 60.08it/s] 12%|█▏        | 115/938 [00:02<00:13, 61.31it/s] 13%|█▎        | 122/938 [00:02<00:13, 59.45it/s] 14%|█▍        | 130/938 [00:02<00:12, 62.37it/s] 15%|█▍        | 137/938 [00:02<00:12, 63.45it/s] 15%|█▌        | 144/938 [00:02<00:12, 64.15it/s] 16%|█▌        | 151/938 [00:02<00:12, 61.51it/s] 17%|█▋        | 158/938 [00:02<00:12, 60.32it/s] 18%|█▊        | 167/938 [00:03<00:11, 66.52it/s] 19%|█▊        | 175/938 [00:03<00:11, 69.27it/s] 20%|█▉        | 184/938 [00:03<00:10, 73.01it/s] 20%|██        | 192/938 [00:03<00:10, 72.86it/s] 21%|██▏       | 200/938 [00:03<00:10, 69.13it/s] 22%|██▏       | 207/938 [00:03<00:10, 67.82it/s] 23%|██▎       | 216/938 [00:03<00:10, 71.86it/s] 24%|██▍       | 225/938 [00:03<00:09, 75.76it/s] 25%|██▍       | 233/938 [00:03<00:09, 76.66it/s] 26%|██▌       | 241/938 [00:04<00:09, 72.69it/s] 27%|██▋       | 249/938 [00:04<00:09, 69.77it/s] 27%|██▋       | 257/938 [00:04<00:09, 70.68it/s] 28%|██▊       | 265/938 [00:04<00:09, 72.03it/s] 29%|██▉       | 274/938 [00:04<00:08, 75.03it/s] 30%|███       | 283/938 [00:04<00:08, 76.44it/s] 31%|███       | 291/938 [00:04<00:08, 73.54it/s] 32%|███▏      | 299/938 [00:04<00:08, 73.12it/s] 33%|███▎      | 307/938 [00:04<00:08, 74.03it/s] 34%|███▎      | 316/938 [00:05<00:08, 76.61it/s] 35%|███▍      | 324/938 [00:05<00:08, 75.97it/s] 35%|███▌      | 332/938 [00:05<00:08, 73.06it/s] 36%|███▌      | 340/938 [00:05<00:08, 71.85it/s] 37%|███▋      | 349/938 [00:05<00:07, 74.98it/s] 38%|███▊      | 358/938 [00:05<00:07, 76.72it/s] 39%|███▉      | 366/938 [00:05<00:07, 74.13it/s] 40%|███▉      | 374/938 [00:05<00:08, 68.12it/s] 41%|████      | 381/938 [00:05<00:08, 68.20it/s] 42%|████▏     | 390/938 [00:06<00:07, 73.71it/s] 43%|████▎     | 399/938 [00:06<00:07, 76.71it/s] 43%|████▎     | 408/938 [00:06<00:06, 77.54it/s] 44%|████▍     | 416/938 [00:06<00:07, 70.44it/s] 45%|████▌     | 424/938 [00:06<00:07, 70.40it/s] 46%|████▌     | 432/938 [00:06<00:07, 71.40it/s] 47%|████▋     | 441/938 [00:06<00:06, 75.56it/s] 48%|████▊     | 450/938 [00:06<00:06, 77.81it/s] 49%|████▉     | 459/938 [00:06<00:06, 79.08it/s] 50%|████▉     | 467/938 [00:07<00:06, 74.28it/s] 51%|█████     | 475/938 [00:07<00:06, 73.62it/s] 51%|█████▏    | 483/938 [00:07<00:06, 73.66it/s] 52%|█████▏    | 492/938 [00:07<00:05, 77.97it/s] 53%|█████▎    | 501/938 [00:07<00:05, 79.21it/s] 54%|█████▍    | 509/938 [00:07<00:05, 76.44it/s] 55%|█████▌    | 517/938 [00:07<00:05, 76.78it/s] 56%|█████▌    | 526/938 [00:07<00:05, 79.60it/s] 57%|█████▋    | 535/938 [00:07<00:04, 82.56it/s] 58%|█████▊    | 544/938 [00:08<00:04, 79.61it/s] 59%|█████▉    | 553/938 [00:08<00:05, 72.84it/s] 60%|█████▉    | 562/938 [00:08<00:05, 74.37it/s] 61%|██████    | 570/938 [00:08<00:04, 73.97it/s] 62%|██████▏   | 578/938 [00:08<00:04, 74.55it/s] 62%|██████▏   | 586/938 [00:08<00:04, 71.57it/s] 63%|██████▎   | 594/938 [00:08<00:04, 69.85it/s] 64%|██████▍   | 602/938 [00:08<00:05, 66.64it/s] 65%|██████▌   | 610/938 [00:09<00:04, 68.80it/s] 66%|██████▌   | 619/938 [00:09<00:04, 73.35it/s] 67%|██████▋   | 627/938 [00:09<00:04, 74.26it/s] 68%|██████▊   | 635/938 [00:09<00:04, 70.90it/s] 69%|██████▊   | 643/938 [00:09<00:04, 70.75it/s] 69%|██████▉   | 651/938 [00:09<00:03, 73.05it/s] 70%|███████   | 660/938 [00:09<00:03, 76.38it/s] 71%|███████   | 668/938 [00:09<00:03, 76.39it/s] 72%|███████▏  | 676/938 [00:09<00:03, 71.74it/s] 73%|███████▎  | 684/938 [00:10<00:03, 68.47it/s] 74%|███████▍  | 694/938 [00:10<00:03, 74.67it/s] 75%|███████▍  | 703/938 [00:10<00:03, 77.36it/s] 76%|███████▌  | 712/938 [00:10<00:02, 80.05it/s] 77%|███████▋  | 721/938 [00:10<00:02, 77.88it/s] 78%|███████▊  | 729/938 [00:10<00:02, 72.17it/s] 79%|███████▊  | 737/938 [00:10<00:02, 74.16it/s] 80%|███████▉  | 746/938 [00:10<00:02, 78.26it/s] 80%|████████  | 755/938 [00:10<00:02, 80.15it/s] 81%|████████▏ | 764/938 [00:11<00:02, 78.07it/s] 82%|████████▏ | 772/938 [00:11<00:02, 76.10it/s] 83%|████████▎ | 780/938 [00:11<00:02, 76.05it/s] 84%|████████▍ | 789/938 [00:11<00:01, 77.86it/s] 85%|████████▍ | 797/938 [00:11<00:01, 78.22it/s] 86%|████████▌ | 806/938 [00:11<00:01, 78.32it/s] 87%|████████▋ | 814/938 [00:11<00:01, 74.69it/s] 88%|████████▊ | 822/938 [00:11<00:01, 73.20it/s] 88%|████████▊ | 830/938 [00:11<00:01, 75.03it/s] 89%|████████▉ | 838/938 [00:12<00:01, 71.28it/s] 90%|█████████ | 846/938 [00:12<00:01, 71.27it/s] 91%|█████████ | 854/938 [00:12<00:01, 64.29it/s] 92%|█████████▏| 861/938 [00:12<00:01, 64.25it/s] 93%|█████████▎| 868/938 [00:12<00:01, 65.22it/s] 93%|█████████▎| 876/938 [00:12<00:00, 68.00it/s] 94%|█████████▍| 883/938 [00:12<00:00, 65.34it/s] 95%|█████████▍| 890/938 [00:12<00:00, 62.72it/s] 96%|█████████▌| 897/938 [00:12<00:00, 64.61it/s] 96%|█████████▋| 904/938 [00:13<00:00, 65.73it/s] 97%|█████████▋| 911/938 [00:13<00:00, 66.34it/s] 98%|█████████▊| 918/938 [00:13<00:00, 62.35it/s] 99%|█████████▊| 925/938 [00:13<00:00, 60.12it/s] 99%|█████████▉| 932/938 [00:13<00:00, 62.21it/s]100%|██████████| 938/938 [00:13<00:00, 68.33it/s]
Train Epoch: 2 	Loss: 0.468870 
Moments Accountant gives: (ε = 5.74, δ = 1e-05) for α = 3.30
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.46it/s] 20%|██        | 2/10 [00:00<00:03,  2.61it/s] 30%|███       | 3/10 [00:01<00:02,  3.26it/s] 40%|████      | 4/10 [00:01<00:01,  4.08it/s] 50%|█████     | 5/10 [00:01<00:01,  4.69it/s] 60%|██████    | 6/10 [00:01<00:00,  5.08it/s] 70%|███████   | 7/10 [00:01<00:00,  5.13it/s] 80%|████████  | 8/10 [00:01<00:00,  5.21it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.24it/s]100%|██████████| 10/10 [00:02<00:00,  5.64it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]

Test set: Average loss: 0.0004, Accuracy: 9149/10000 (91.49%)

Training membership inference attack model
Base model accuracy:  0.9149
Random forest model attack results: 
train acc: 0.9997166666666667
test acc: 0.5008
total acc: 0.9284428571428571
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.35it/s] 20%|██        | 2/10 [00:00<00:03,  2.53it/s] 30%|███       | 3/10 [00:01<00:02,  3.47it/s] 40%|████      | 4/10 [00:01<00:01,  3.95it/s] 50%|█████     | 5/10 [00:01<00:01,  4.64it/s] 60%|██████    | 6/10 [00:01<00:00,  5.10it/s] 70%|███████   | 7/10 [00:01<00:00,  5.33it/s] 80%|████████  | 8/10 [00:01<00:00,  5.41it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.65it/s]100%|██████████| 10/10 [00:02<00:00,  6.26it/s]100%|██████████| 10/10 [00:02<00:00,  4.21it/s]

Test set: Average loss: 0.0004, Accuracy: 9149/10000 (91.49%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:02<39:36,  2.54s/it]  1%|          | 8/938 [00:02<03:46,  4.10it/s]  2%|▏         | 17/938 [00:02<01:31, 10.10it/s]  3%|▎         | 25/938 [00:02<00:55, 16.40it/s]  4%|▎         | 33/938 [00:02<00:38, 23.50it/s]  4%|▍         | 40/938 [00:03<00:30, 29.64it/s]  5%|▌         | 47/938 [00:03<00:24, 35.74it/s]  6%|▌         | 55/938 [00:03<00:20, 43.51it/s]  7%|▋         | 64/938 [00:03<00:16, 52.06it/s]  8%|▊         | 72/938 [00:03<00:15, 57.73it/s]  9%|▊         | 80/938 [00:03<00:14, 59.93it/s]  9%|▉         | 88/938 [00:03<00:13, 61.29it/s] 10%|█         | 95/938 [00:03<00:13, 62.40it/s] 11%|█         | 103/938 [00:03<00:12, 65.22it/s] 12%|█▏        | 112/938 [00:04<00:11, 70.54it/s] 13%|█▎        | 121/938 [00:04<00:11, 74.14it/s] 14%|█▍        | 129/938 [00:04<00:10, 75.31it/s] 15%|█▍        | 137/938 [00:04<00:10, 72.90it/s] 15%|█▌        | 145/938 [00:04<00:11, 70.20it/s] 16%|█▋        | 153/938 [00:04<00:11, 70.91it/s] 17%|█▋        | 162/938 [00:04<00:10, 73.91it/s] 18%|█▊        | 171/938 [00:04<00:09, 76.76it/s] 19%|█▉        | 179/938 [00:04<00:10, 73.36it/s] 20%|█▉        | 187/938 [00:05<00:10, 73.02it/s] 21%|██        | 195/938 [00:05<00:10, 70.89it/s] 22%|██▏       | 203/938 [00:05<00:10, 72.47it/s] 22%|██▏       | 211/938 [00:05<00:09, 73.26it/s] 23%|██▎       | 219/938 [00:05<00:10, 70.41it/s] 24%|██▍       | 227/938 [00:05<00:10, 70.25it/s] 25%|██▌       | 235/938 [00:05<00:10, 67.92it/s] 26%|██▌       | 243/938 [00:05<00:09, 69.78it/s] 27%|██▋       | 252/938 [00:05<00:09, 73.33it/s] 28%|██▊       | 261/938 [00:06<00:08, 76.27it/s] 29%|██▊       | 269/938 [00:06<00:08, 76.06it/s] 30%|██▉       | 277/938 [00:06<00:09, 73.02it/s] 30%|███       | 285/938 [00:06<00:09, 71.66it/s] 31%|███▏      | 294/938 [00:06<00:08, 74.20it/s] 32%|███▏      | 303/938 [00:06<00:08, 76.96it/s] 33%|███▎      | 311/938 [00:06<00:08, 77.76it/s] 34%|███▍      | 319/938 [00:06<00:08, 74.81it/s] 35%|███▍      | 327/938 [00:07<00:08, 69.16it/s] 36%|███▌      | 336/938 [00:07<00:08, 72.95it/s] 37%|███▋      | 345/938 [00:07<00:07, 75.83it/s] 38%|███▊      | 353/938 [00:07<00:08, 71.41it/s] 38%|███▊      | 361/938 [00:07<00:08, 65.84it/s] 39%|███▉      | 368/938 [00:07<00:09, 63.22it/s] 40%|███▉      | 375/938 [00:07<00:09, 60.38it/s] 41%|████      | 382/938 [00:07<00:09, 58.80it/s] 41%|████▏     | 388/938 [00:08<00:09, 55.43it/s] 42%|████▏     | 394/938 [00:08<00:10, 52.00it/s] 43%|████▎     | 400/938 [00:08<00:10, 53.35it/s] 43%|████▎     | 406/938 [00:08<00:09, 53.79it/s] 44%|████▍     | 412/938 [00:08<00:09, 55.39it/s] 45%|████▍     | 419/938 [00:08<00:09, 57.15it/s] 45%|████▌     | 426/938 [00:08<00:08, 58.42it/s] 46%|████▌     | 433/938 [00:08<00:08, 61.44it/s] 47%|████▋     | 442/938 [00:08<00:07, 68.35it/s] 48%|████▊     | 450/938 [00:09<00:06, 69.76it/s] 49%|████▉     | 459/938 [00:09<00:06, 74.15it/s] 50%|████▉     | 467/938 [00:09<00:06, 75.40it/s] 51%|█████     | 475/938 [00:09<00:06, 72.89it/s] 51%|█████▏    | 483/938 [00:09<00:06, 69.90it/s] 52%|█████▏    | 491/938 [00:09<00:06, 69.10it/s] 53%|█████▎    | 499/938 [00:09<00:06, 69.32it/s] 54%|█████▍    | 506/938 [00:09<00:06, 68.63it/s] 55%|█████▍    | 513/938 [00:09<00:06, 62.59it/s] 55%|█████▌    | 520/938 [00:10<00:06, 61.95it/s] 56%|█████▌    | 527/938 [00:10<00:06, 63.99it/s] 57%|█████▋    | 534/938 [00:10<00:06, 64.85it/s] 58%|█████▊    | 541/938 [00:10<00:06, 66.09it/s] 58%|█████▊    | 548/938 [00:10<00:06, 63.27it/s] 59%|█████▉    | 555/938 [00:10<00:05, 64.58it/s] 60%|██████    | 564/938 [00:10<00:05, 70.29it/s] 61%|██████    | 573/938 [00:10<00:04, 74.55it/s] 62%|██████▏   | 582/938 [00:10<00:04, 76.96it/s] 63%|██████▎   | 590/938 [00:11<00:04, 77.26it/s] 64%|██████▍   | 598/938 [00:11<00:04, 73.37it/s] 65%|██████▍   | 606/938 [00:11<00:04, 68.51it/s] 65%|██████▌   | 614/938 [00:11<00:04, 71.39it/s] 66%|██████▋   | 622/938 [00:11<00:04, 73.65it/s] 67%|██████▋   | 631/938 [00:11<00:04, 76.58it/s] 68%|██████▊   | 639/938 [00:11<00:03, 76.82it/s] 69%|██████▉   | 647/938 [00:11<00:04, 70.89it/s] 70%|██████▉   | 655/938 [00:11<00:03, 72.29it/s] 71%|███████   | 663/938 [00:12<00:03, 74.20it/s] 72%|███████▏  | 672/938 [00:12<00:03, 76.97it/s] 72%|███████▏  | 680/938 [00:12<00:03, 77.24it/s] 73%|███████▎  | 688/938 [00:12<00:03, 71.68it/s] 74%|███████▍  | 696/938 [00:12<00:03, 69.98it/s] 75%|███████▌  | 704/938 [00:12<00:03, 72.62it/s] 76%|███████▌  | 712/938 [00:12<00:03, 66.10it/s] 77%|███████▋  | 719/938 [00:12<00:03, 65.27it/s] 77%|███████▋  | 726/938 [00:12<00:03, 65.06it/s] 78%|███████▊  | 734/938 [00:13<00:03, 66.51it/s] 79%|███████▉  | 743/938 [00:13<00:02, 70.31it/s] 80%|████████  | 751/938 [00:13<00:02, 70.45it/s] 81%|████████  | 759/938 [00:13<00:02, 71.95it/s] 82%|████████▏ | 767/938 [00:13<00:02, 68.93it/s] 83%|████████▎ | 775/938 [00:13<00:02, 70.11it/s] 84%|████████▎ | 784/938 [00:13<00:02, 73.38it/s] 85%|████████▍ | 793/938 [00:13<00:01, 77.13it/s] 86%|████████▌ | 802/938 [00:13<00:01, 78.52it/s] 86%|████████▋ | 811/938 [00:14<00:01, 79.16it/s] 87%|████████▋ | 819/938 [00:14<00:01, 75.61it/s] 88%|████████▊ | 827/938 [00:14<00:01, 76.34it/s] 89%|████████▉ | 836/938 [00:14<00:01, 79.36it/s] 90%|█████████ | 845/938 [00:14<00:01, 79.78it/s] 91%|█████████ | 854/938 [00:14<00:01, 81.25it/s] 92%|█████████▏| 863/938 [00:14<00:00, 79.92it/s] 93%|█████████▎| 872/938 [00:14<00:00, 78.64it/s] 94%|█████████▍| 881/938 [00:14<00:00, 79.73it/s] 95%|█████████▍| 890/938 [00:15<00:00, 81.24it/s] 96%|█████████▌| 899/938 [00:15<00:00, 74.68it/s] 97%|█████████▋| 907/938 [00:15<00:00, 66.43it/s] 98%|█████████▊| 915/938 [00:15<00:00, 67.32it/s] 98%|█████████▊| 922/938 [00:15<00:00, 65.86it/s] 99%|█████████▉| 929/938 [00:15<00:00, 66.77it/s]100%|█████████▉| 936/938 [00:15<00:00, 65.52it/s]100%|██████████| 938/938 [00:16<00:00, 58.62it/s]
Train Epoch: 1 	Loss: 0.953648 
Moments Accountant gives: (ε = 0.96, δ = 1e-05) for α = 13.40
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.55it/s] 20%|██        | 2/10 [00:00<00:02,  2.71it/s] 30%|███       | 3/10 [00:00<00:01,  3.69it/s] 40%|████      | 4/10 [00:01<00:01,  4.27it/s] 50%|█████     | 5/10 [00:01<00:01,  4.75it/s] 60%|██████    | 6/10 [00:01<00:00,  5.25it/s] 70%|███████   | 7/10 [00:01<00:00,  5.38it/s] 80%|████████  | 8/10 [00:01<00:00,  5.41it/s] 90%|█████████ | 9/10 [00:01<00:00,  5.69it/s]100%|██████████| 10/10 [00:02<00:00,  6.29it/s]100%|██████████| 10/10 [00:02<00:00,  4.38it/s]

Test set: Average loss: 0.0006, Accuracy: 8583/10000 (85.83%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<04:18,  3.62it/s]  1%|          | 10/938 [00:00<00:28, 33.03it/s]  2%|▏         | 18/938 [00:00<00:19, 47.58it/s]  3%|▎         | 26/938 [00:00<00:15, 57.01it/s]  4%|▎         | 34/938 [00:00<00:14, 63.20it/s]  5%|▍         | 43/938 [00:00<00:12, 69.69it/s]  5%|▌         | 51/938 [00:00<00:12, 71.69it/s]  6%|▋         | 59/938 [00:01<00:12, 71.80it/s]  7%|▋         | 67/938 [00:01<00:12, 72.01it/s]  8%|▊         | 76/938 [00:01<00:11, 75.18it/s]  9%|▉         | 84/938 [00:01<00:11, 74.92it/s] 10%|▉         | 92/938 [00:01<00:11, 71.51it/s] 11%|█         | 100/938 [00:01<00:11, 71.23it/s] 12%|█▏        | 109/938 [00:01<00:11, 74.77it/s] 12%|█▏        | 117/938 [00:01<00:10, 74.99it/s] 13%|█▎        | 125/938 [00:01<00:10, 74.95it/s] 14%|█▍        | 133/938 [00:02<00:12, 65.76it/s] 15%|█▍        | 140/938 [00:02<00:13, 58.26it/s] 16%|█▌        | 147/938 [00:02<00:14, 55.70it/s] 16%|█▋        | 153/938 [00:02<00:14, 55.25it/s] 17%|█▋        | 159/938 [00:02<00:14, 53.26it/s] 18%|█▊        | 165/938 [00:02<00:15, 49.95it/s] 18%|█▊        | 171/938 [00:02<00:16, 46.38it/s] 19%|█▉        | 176/938 [00:02<00:16, 46.05it/s] 19%|█▉        | 182/938 [00:03<00:15, 47.73it/s] 20%|█▉        | 187/938 [00:03<00:15, 47.79it/s] 21%|██        | 195/938 [00:03<00:13, 55.20it/s] 22%|██▏       | 202/938 [00:03<00:12, 58.82it/s] 22%|██▏       | 208/938 [00:03<00:13, 55.99it/s] 23%|██▎       | 214/938 [00:03<00:13, 54.53it/s] 24%|██▎       | 222/938 [00:03<00:11, 60.17it/s] 25%|██▍       | 230/938 [00:03<00:11, 64.05it/s] 25%|██▌       | 238/938 [00:03<00:10, 66.90it/s] 26%|██▌       | 245/938 [00:04<00:10, 66.60it/s] 27%|██▋       | 252/938 [00:04<00:10, 62.52it/s] 28%|██▊       | 260/938 [00:04<00:10, 66.60it/s] 29%|██▊       | 268/938 [00:04<00:09, 69.19it/s] 29%|██▉       | 276/938 [00:04<00:09, 71.81it/s] 30%|███       | 284/938 [00:04<00:09, 72.31it/s] 31%|███       | 292/938 [00:04<00:09, 69.54it/s] 32%|███▏      | 300/938 [00:04<00:09, 68.14it/s] 33%|███▎      | 308/938 [00:04<00:08, 70.92it/s] 34%|███▍      | 317/938 [00:05<00:08, 74.29it/s] 35%|███▍      | 326/938 [00:05<00:08, 76.44it/s] 36%|███▌      | 334/938 [00:05<00:08, 71.74it/s] 36%|███▋      | 342/938 [00:05<00:08, 72.11it/s] 37%|███▋      | 351/938 [00:05<00:07, 74.97it/s] 38%|███▊      | 360/938 [00:05<00:07, 77.44it/s] 39%|███▉      | 368/938 [00:05<00:07, 78.08it/s] 40%|████      | 376/938 [00:05<00:07, 75.73it/s] 41%|████      | 384/938 [00:05<00:07, 74.55it/s] 42%|████▏     | 393/938 [00:06<00:07, 77.05it/s] 43%|████▎     | 402/938 [00:06<00:06, 79.16it/s] 44%|████▍     | 411/938 [00:06<00:06, 79.64it/s] 45%|████▍     | 419/938 [00:06<00:06, 74.30it/s] 46%|████▌     | 427/938 [00:06<00:07, 72.36it/s] 46%|████▋     | 436/938 [00:06<00:06, 75.88it/s] 47%|████▋     | 445/938 [00:06<00:06, 77.04it/s] 48%|████▊     | 454/938 [00:06<00:06, 79.50it/s] 49%|████▉     | 462/938 [00:07<00:06, 76.06it/s] 50%|█████     | 470/938 [00:07<00:06, 74.05it/s] 51%|█████     | 479/938 [00:07<00:05, 76.78it/s] 52%|█████▏    | 487/938 [00:07<00:05, 76.82it/s] 53%|█████▎    | 496/938 [00:07<00:05, 78.42it/s] 54%|█████▎    | 504/938 [00:07<00:06, 69.06it/s] 55%|█████▍    | 512/938 [00:07<00:06, 61.26it/s] 55%|█████▌    | 519/938 [00:07<00:07, 57.77it/s] 56%|█████▌    | 527/938 [00:08<00:06, 62.38it/s] 57%|█████▋    | 535/938 [00:08<00:06, 65.10it/s] 58%|█████▊    | 542/938 [00:08<00:05, 66.02it/s] 59%|█████▊    | 549/938 [00:08<00:05, 66.97it/s] 59%|█████▉    | 558/938 [00:08<00:05, 71.25it/s] 60%|██████    | 567/938 [00:08<00:04, 74.43it/s] 61%|██████▏   | 575/938 [00:08<00:04, 72.94it/s] 62%|██████▏   | 583/938 [00:08<00:05, 69.60it/s] 63%|██████▎   | 592/938 [00:08<00:04, 72.79it/s] 64%|██████▍   | 601/938 [00:08<00:04, 75.61it/s] 65%|██████▌   | 610/938 [00:09<00:04, 75.83it/s] 66%|██████▌   | 618/938 [00:09<00:04, 76.57it/s] 67%|██████▋   | 626/938 [00:09<00:04, 67.77it/s] 67%|██████▋   | 633/938 [00:09<00:04, 62.01it/s] 68%|██████▊   | 640/938 [00:09<00:04, 63.66it/s] 69%|██████▉   | 647/938 [00:09<00:04, 62.67it/s] 70%|██████▉   | 654/938 [00:09<00:04, 64.46it/s] 70%|███████   | 661/938 [00:09<00:04, 64.01it/s] 71%|███████   | 668/938 [00:10<00:04, 63.69it/s] 72%|███████▏  | 675/938 [00:10<00:04, 61.65it/s] 73%|███████▎  | 682/938 [00:10<00:04, 61.80it/s] 73%|███████▎  | 689/938 [00:10<00:04, 60.23it/s] 74%|███████▍  | 696/938 [00:10<00:03, 61.14it/s] 75%|███████▍  | 703/938 [00:10<00:03, 60.68it/s] 76%|███████▌  | 711/938 [00:10<00:03, 62.55it/s] 77%|███████▋  | 718/938 [00:10<00:03, 63.09it/s] 77%|███████▋  | 726/938 [00:10<00:03, 65.74it/s] 78%|███████▊  | 733/938 [00:11<00:03, 64.16it/s] 79%|███████▉  | 740/938 [00:11<00:03, 64.09it/s] 80%|███████▉  | 747/938 [00:11<00:02, 65.66it/s] 80%|████████  | 754/938 [00:11<00:02, 65.53it/s] 81%|████████  | 762/938 [00:11<00:02, 67.24it/s] 82%|████████▏ | 769/938 [00:11<00:02, 64.47it/s] 83%|████████▎ | 776/938 [00:11<00:02, 65.49it/s] 83%|████████▎ | 783/938 [00:11<00:02, 65.12it/s] 84%|████████▍ | 791/938 [00:11<00:02, 67.30it/s] 85%|████████▌ | 798/938 [00:12<00:02, 67.66it/s] 86%|████████▌ | 805/938 [00:12<00:02, 65.85it/s] 87%|████████▋ | 812/938 [00:12<00:02, 62.81it/s] 87%|████████▋ | 819/938 [00:12<00:01, 62.34it/s] 88%|████████▊ | 826/938 [00:12<00:01, 63.51it/s] 89%|████████▉ | 833/938 [00:12<00:01, 62.94it/s] 90%|████████▉ | 841/938 [00:12<00:01, 66.49it/s] 90%|█████████ | 848/938 [00:12<00:01, 65.58it/s] 91%|█████████ | 855/938 [00:12<00:01, 65.74it/s] 92%|█████████▏| 863/938 [00:13<00:01, 67.95it/s] 93%|█████████▎| 871/938 [00:13<00:00, 70.66it/s] 94%|█████████▎| 879/938 [00:13<00:00, 70.28it/s] 95%|█████████▍| 887/938 [00:13<00:00, 68.09it/s] 95%|█████████▌| 894/938 [00:13<00:00, 63.10it/s] 96%|█████████▌| 901/938 [00:13<00:00, 60.86it/s] 97%|█████████▋| 908/938 [00:13<00:00, 61.88it/s] 98%|█████████▊| 915/938 [00:13<00:00, 63.94it/s] 98%|█████████▊| 922/938 [00:13<00:00, 63.25it/s] 99%|█████████▉| 929/938 [00:14<00:00, 61.71it/s]100%|█████████▉| 936/938 [00:14<00:00, 57.95it/s]100%|██████████| 938/938 [00:14<00:00, 64.87it/s]
Train Epoch: 2 	Loss: 0.550342 
Moments Accountant gives: (ε = 0.98, δ = 1e-05) for α = 13.30
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:07,  1.13it/s] 20%|██        | 2/10 [00:01<00:03,  2.09it/s] 30%|███       | 3/10 [00:01<00:02,  2.84it/s] 40%|████      | 4/10 [00:01<00:01,  3.40it/s] 50%|█████     | 5/10 [00:01<00:01,  3.95it/s] 60%|██████    | 6/10 [00:01<00:00,  4.29it/s] 70%|███████   | 7/10 [00:02<00:00,  4.48it/s] 80%|████████  | 8/10 [00:02<00:00,  4.82it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.95it/s]100%|██████████| 10/10 [00:02<00:00,  5.31it/s]100%|██████████| 10/10 [00:02<00:00,  3.60it/s]

Test set: Average loss: 0.0005, Accuracy: 8984/10000 (89.84%)

Training membership inference attack model
Base model accuracy:  0.8984
Random forest model attack results: 
train acc: 0.9997833333333334
test acc: 0.5005999999999999
total acc: 0.9284714285714286
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:04<00:38,  4.33s/it] 20%|██        | 2/10 [00:04<00:15,  1.92s/it] 30%|███       | 3/10 [00:04<00:07,  1.13s/it] 40%|████      | 4/10 [00:04<00:04,  1.32it/s] 50%|█████     | 5/10 [00:05<00:02,  1.80it/s] 60%|██████    | 6/10 [00:05<00:01,  2.26it/s] 70%|███████   | 7/10 [00:05<00:01,  2.51it/s] 80%|████████  | 8/10 [00:05<00:00,  2.80it/s] 90%|█████████ | 9/10 [00:06<00:00,  3.28it/s]100%|██████████| 10/10 [00:06<00:00,  3.78it/s]100%|██████████| 10/10 [00:06<00:00,  1.53it/s]

Test set: Average loss: 0.0005, Accuracy: 8984/10000 (89.84%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:02<32:59,  2.11s/it]  1%|          | 6/938 [00:02<04:21,  3.56it/s]  1%|▏         | 14/938 [00:02<01:35,  9.71it/s]  2%|▏         | 20/938 [00:02<01:02, 14.72it/s]  3%|▎         | 27/938 [00:02<00:42, 21.62it/s]  4%|▎         | 34/938 [00:02<00:31, 28.66it/s]  4%|▍         | 40/938 [00:02<00:26, 34.23it/s]  5%|▌         | 48/938 [00:02<00:20, 43.48it/s]  6%|▌         | 55/938 [00:02<00:18, 48.52it/s]  7%|▋         | 62/938 [00:03<00:17, 50.23it/s]  7%|▋         | 69/938 [00:03<00:16, 53.80it/s]  8%|▊         | 76/938 [00:03<00:14, 57.76it/s]  9%|▉         | 83/938 [00:03<00:14, 60.77it/s] 10%|▉         | 90/938 [00:03<00:13, 62.40it/s] 10%|█         | 98/938 [00:03<00:12, 66.69it/s] 11%|█         | 105/938 [00:03<00:12, 66.69it/s] 12%|█▏        | 112/938 [00:03<00:12, 67.16it/s] 13%|█▎        | 120/938 [00:03<00:11, 70.05it/s] 14%|█▎        | 128/938 [00:04<00:11, 69.69it/s] 14%|█▍        | 136/938 [00:04<00:11, 68.67it/s] 15%|█▌        | 143/938 [00:04<00:11, 67.94it/s] 16%|█▌        | 150/938 [00:04<00:12, 65.34it/s] 17%|█▋        | 157/938 [00:04<00:12, 63.12it/s] 17%|█▋        | 164/938 [00:04<00:12, 64.17it/s] 18%|█▊        | 171/938 [00:04<00:12, 63.30it/s] 19%|█▉        | 178/938 [00:04<00:12, 62.83it/s] 20%|█▉        | 186/938 [00:04<00:11, 64.31it/s] 21%|██        | 193/938 [00:05<00:11, 65.53it/s] 21%|██▏       | 200/938 [00:05<00:11, 62.43it/s] 22%|██▏       | 207/938 [00:05<00:11, 61.26it/s] 23%|██▎       | 214/938 [00:05<00:11, 61.58it/s] 24%|██▎       | 221/938 [00:05<00:11, 62.55it/s] 25%|██▍       | 230/938 [00:05<00:10, 67.27it/s] 25%|██▌       | 237/938 [00:05<00:10, 63.92it/s] 26%|██▌       | 244/938 [00:05<00:11, 61.04it/s] 27%|██▋       | 251/938 [00:06<00:11, 62.42it/s] 28%|██▊       | 259/938 [00:06<00:10, 64.63it/s] 28%|██▊       | 267/938 [00:06<00:09, 68.49it/s] 29%|██▉       | 275/938 [00:06<00:09, 69.29it/s] 30%|███       | 282/938 [00:06<00:09, 67.46it/s] 31%|███       | 289/938 [00:06<00:10, 62.24it/s] 32%|███▏      | 296/938 [00:06<00:11, 57.03it/s] 32%|███▏      | 302/938 [00:06<00:11, 54.31it/s] 33%|███▎      | 308/938 [00:06<00:11, 54.11it/s] 34%|███▎      | 316/938 [00:07<00:10, 59.84it/s] 34%|███▍      | 323/938 [00:07<00:10, 60.18it/s] 35%|███▌      | 331/938 [00:07<00:09, 64.43it/s] 36%|███▌      | 339/938 [00:07<00:08, 67.95it/s] 37%|███▋      | 346/938 [00:07<00:08, 68.37it/s] 38%|███▊      | 353/938 [00:07<00:08, 68.36it/s] 38%|███▊      | 361/938 [00:07<00:08, 71.35it/s] 39%|███▉      | 369/938 [00:07<00:07, 71.72it/s] 40%|████      | 377/938 [00:07<00:07, 72.28it/s] 41%|████      | 385/938 [00:08<00:07, 70.26it/s] 42%|████▏     | 393/938 [00:08<00:07, 70.55it/s] 43%|████▎     | 401/938 [00:08<00:07, 70.89it/s] 44%|████▎     | 409/938 [00:08<00:07, 70.35it/s] 44%|████▍     | 417/938 [00:08<00:07, 71.31it/s] 45%|████▌     | 425/938 [00:08<00:07, 69.07it/s] 46%|████▌     | 432/938 [00:08<00:07, 66.68it/s] 47%|████▋     | 440/938 [00:08<00:07, 68.05it/s] 48%|████▊     | 449/938 [00:08<00:06, 72.03it/s] 49%|████▊     | 457/938 [00:09<00:06, 71.72it/s] 50%|████▉     | 465/938 [00:09<00:06, 72.96it/s] 50%|█████     | 473/938 [00:09<00:06, 70.30it/s] 51%|█████▏    | 481/938 [00:09<00:06, 70.52it/s] 52%|█████▏    | 489/938 [00:09<00:06, 70.24it/s] 53%|█████▎    | 497/938 [00:09<00:06, 64.94it/s] 54%|█████▎    | 504/938 [00:09<00:07, 59.55it/s] 54%|█████▍    | 511/938 [00:09<00:07, 60.14it/s] 55%|█████▌    | 518/938 [00:10<00:06, 60.73it/s] 56%|█████▌    | 525/938 [00:10<00:06, 61.91it/s] 57%|█████▋    | 532/938 [00:10<00:06, 61.79it/s] 58%|█████▊    | 541/938 [00:10<00:05, 67.46it/s] 58%|█████▊    | 548/938 [00:10<00:05, 67.12it/s] 59%|█████▉    | 556/938 [00:10<00:05, 68.69it/s] 60%|██████    | 564/938 [00:10<00:05, 69.91it/s] 61%|██████    | 572/938 [00:10<00:05, 71.79it/s] 62%|██████▏   | 580/938 [00:10<00:04, 72.87it/s] 63%|██████▎   | 588/938 [00:11<00:04, 73.42it/s] 64%|██████▎   | 596/938 [00:11<00:04, 73.27it/s] 64%|██████▍   | 604/938 [00:11<00:04, 72.36it/s] 65%|██████▌   | 612/938 [00:11<00:04, 73.26it/s] 66%|██████▌   | 620/938 [00:11<00:04, 68.44it/s] 67%|██████▋   | 628/938 [00:11<00:04, 70.54it/s] 68%|██████▊   | 636/938 [00:11<00:04, 69.62it/s] 69%|██████▊   | 644/938 [00:11<00:04, 72.09it/s] 70%|██████▉   | 652/938 [00:11<00:03, 72.08it/s] 70%|███████   | 660/938 [00:12<00:03, 72.18it/s] 71%|███████   | 668/938 [00:12<00:03, 73.44it/s] 72%|███████▏  | 676/938 [00:12<00:03, 72.68it/s] 73%|███████▎  | 684/938 [00:12<00:03, 74.59it/s] 74%|███████▍  | 692/938 [00:12<00:03, 73.35it/s] 75%|███████▍  | 701/938 [00:12<00:03, 75.40it/s] 76%|███████▌  | 709/938 [00:12<00:03, 73.69it/s] 76%|███████▋  | 717/938 [00:12<00:02, 75.25it/s] 77%|███████▋  | 725/938 [00:12<00:02, 74.90it/s] 78%|███████▊  | 734/938 [00:13<00:02, 76.78it/s] 79%|███████▉  | 742/938 [00:13<00:02, 77.01it/s] 80%|███████▉  | 750/938 [00:13<00:02, 72.53it/s] 81%|████████  | 758/938 [00:13<00:02, 72.96it/s] 82%|████████▏ | 766/938 [00:13<00:02, 71.04it/s] 83%|████████▎ | 774/938 [00:13<00:02, 71.24it/s] 83%|████████▎ | 782/938 [00:13<00:02, 68.98it/s] 84%|████████▍ | 789/938 [00:13<00:02, 65.95it/s] 85%|████████▍ | 796/938 [00:13<00:02, 62.27it/s] 86%|████████▌ | 803/938 [00:14<00:02, 59.95it/s] 86%|████████▋ | 810/938 [00:14<00:02, 59.83it/s] 87%|████████▋ | 817/938 [00:14<00:02, 59.30it/s] 88%|████████▊ | 823/938 [00:14<00:02, 56.64it/s] 88%|████████▊ | 829/938 [00:14<00:01, 54.72it/s] 89%|████████▉ | 835/938 [00:14<00:01, 54.90it/s] 90%|████████▉ | 843/938 [00:14<00:01, 59.66it/s] 91%|█████████ | 851/938 [00:14<00:01, 63.83it/s] 91%|█████████▏| 858/938 [00:14<00:01, 62.41it/s] 92%|█████████▏| 866/938 [00:15<00:01, 64.00it/s] 93%|█████████▎| 873/938 [00:15<00:01, 62.66it/s] 94%|█████████▍| 880/938 [00:15<00:00, 62.12it/s] 95%|█████████▍| 887/938 [00:15<00:00, 62.58it/s] 95%|█████████▌| 894/938 [00:15<00:00, 63.06it/s] 96%|█████████▌| 902/938 [00:15<00:00, 63.59it/s] 97%|█████████▋| 909/938 [00:15<00:00, 61.95it/s] 98%|█████████▊| 916/938 [00:15<00:00, 59.15it/s] 98%|█████████▊| 922/938 [00:16<00:00, 58.78it/s] 99%|█████████▉| 930/938 [00:16<00:00, 61.43it/s]100%|██████████| 938/938 [00:16<00:00, 56.97it/s]
Train Epoch: 1 	Loss: 0.993930 
Moments Accountant gives: (ε = 0.40, δ = 1e-05) for α = 30.40
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:09,  1.06s/it] 20%|██        | 2/10 [00:01<00:04,  1.83it/s] 30%|███       | 3/10 [00:01<00:02,  2.63it/s] 40%|████      | 4/10 [00:01<00:01,  3.30it/s] 50%|█████     | 5/10 [00:01<00:01,  3.89it/s] 60%|██████    | 6/10 [00:01<00:00,  4.27it/s] 70%|███████   | 7/10 [00:02<00:00,  4.55it/s] 80%|████████  | 8/10 [00:02<00:00,  4.93it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.97it/s]100%|██████████| 10/10 [00:02<00:00,  5.24it/s]100%|██████████| 10/10 [00:02<00:00,  3.46it/s]

Test set: Average loss: 0.0006, Accuracy: 8524/10000 (85.24%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<04:31,  3.46it/s]  1%|          | 7/938 [00:00<00:44, 20.79it/s]  1%|▏         | 14/938 [00:00<00:26, 34.83it/s]  2%|▏         | 22/938 [00:00<00:18, 48.24it/s]  3%|▎         | 30/938 [00:00<00:16, 55.79it/s]  4%|▍         | 37/938 [00:00<00:17, 52.69it/s]  5%|▍         | 43/938 [00:01<00:19, 45.02it/s]  5%|▌         | 49/938 [00:01<00:20, 43.52it/s]  6%|▌         | 54/938 [00:01<00:19, 44.33it/s]  6%|▋         | 59/938 [00:01<00:19, 45.62it/s]  7%|▋         | 66/938 [00:01<00:18, 48.12it/s]  8%|▊         | 71/938 [00:01<00:18, 48.05it/s]  8%|▊         | 77/938 [00:01<00:17, 48.78it/s]  9%|▊         | 82/938 [00:01<00:18, 45.59it/s]  9%|▉         | 87/938 [00:02<00:19, 44.49it/s] 10%|▉         | 93/938 [00:02<00:17, 47.11it/s] 10%|█         | 98/938 [00:02<00:17, 46.93it/s] 11%|█         | 104/938 [00:02<00:17, 48.21it/s] 12%|█▏        | 109/938 [00:02<00:17, 47.77it/s] 12%|█▏        | 116/938 [00:02<00:17, 48.35it/s] 13%|█▎        | 122/938 [00:02<00:16, 50.60it/s] 14%|█▎        | 128/938 [00:02<00:16, 48.33it/s] 14%|█▍        | 134/938 [00:02<00:15, 50.50it/s] 15%|█▍        | 140/938 [00:03<00:15, 50.22it/s] 16%|█▌        | 146/938 [00:03<00:17, 44.12it/s] 16%|█▌        | 151/938 [00:03<00:19, 41.16it/s] 17%|█▋        | 156/938 [00:03<00:18, 42.18it/s] 17%|█▋        | 161/938 [00:03<00:18, 42.52it/s] 18%|█▊        | 166/938 [00:03<00:17, 43.49it/s] 18%|█▊        | 171/938 [00:03<00:17, 42.98it/s] 19%|█▉        | 176/938 [00:03<00:18, 41.76it/s] 19%|█▉        | 181/938 [00:04<00:19, 39.17it/s] 20%|█▉        | 185/938 [00:04<00:19, 38.21it/s] 20%|██        | 190/938 [00:04<00:18, 39.55it/s] 21%|██        | 196/938 [00:04<00:17, 42.47it/s] 21%|██▏       | 201/938 [00:04<00:18, 40.61it/s] 22%|██▏       | 206/938 [00:04<00:18, 40.40it/s] 22%|██▏       | 211/938 [00:04<00:17, 40.80it/s] 23%|██▎       | 216/938 [00:04<00:17, 41.80it/s] 24%|██▎       | 221/938 [00:05<00:17, 40.63it/s] 24%|██▍       | 226/938 [00:05<00:17, 41.50it/s] 25%|██▍       | 231/938 [00:05<00:17, 40.25it/s] 25%|██▌       | 236/938 [00:05<00:17, 39.83it/s] 26%|██▌       | 242/938 [00:05<00:15, 43.60it/s] 27%|██▋       | 249/938 [00:05<00:14, 49.07it/s] 27%|██▋       | 254/938 [00:05<00:14, 48.55it/s] 28%|██▊       | 259/938 [00:05<00:14, 47.80it/s] 28%|██▊       | 264/938 [00:06<00:14, 47.49it/s] 29%|██▉       | 270/938 [00:06<00:13, 48.67it/s] 29%|██▉       | 275/938 [00:06<00:13, 47.63it/s] 30%|██▉       | 281/938 [00:06<00:13, 48.37it/s] 31%|███       | 288/938 [00:06<00:12, 52.93it/s] 31%|███▏      | 295/938 [00:06<00:11, 54.66it/s] 32%|███▏      | 301/938 [00:06<00:11, 54.53it/s] 33%|███▎      | 307/938 [00:06<00:11, 55.43it/s] 33%|███▎      | 313/938 [00:06<00:11, 55.09it/s] 34%|███▍      | 319/938 [00:07<00:11, 55.05it/s] 35%|███▍      | 325/938 [00:07<00:11, 51.98it/s] 35%|███▌      | 331/938 [00:07<00:13, 44.44it/s] 36%|███▌      | 336/938 [00:07<00:13, 44.91it/s] 36%|███▋      | 342/938 [00:07<00:12, 46.77it/s] 37%|███▋      | 347/938 [00:07<00:13, 44.63it/s] 38%|███▊      | 352/938 [00:07<00:13, 41.91it/s] 38%|███▊      | 357/938 [00:07<00:13, 43.15it/s] 39%|███▊      | 362/938 [00:08<00:13, 42.55it/s] 39%|███▉      | 367/938 [00:08<00:13, 42.96it/s] 40%|███▉      | 373/938 [00:08<00:12, 45.00it/s] 40%|████      | 378/938 [00:08<00:12, 45.35it/s] 41%|████      | 384/938 [00:08<00:12, 44.92it/s] 41%|████▏     | 389/938 [00:08<00:12, 44.45it/s] 42%|████▏     | 394/938 [00:08<00:12, 45.21it/s] 43%|████▎     | 399/938 [00:08<00:12, 44.22it/s] 43%|████▎     | 404/938 [00:08<00:11, 45.53it/s] 44%|████▎     | 409/938 [00:09<00:11, 45.80it/s] 44%|████▍     | 414/938 [00:09<00:11, 45.63it/s] 45%|████▍     | 419/938 [00:09<00:12, 41.44it/s] 45%|████▌     | 424/938 [00:09<00:14, 36.08it/s] 46%|████▌     | 429/938 [00:09<00:13, 37.66it/s] 46%|████▋     | 434/938 [00:09<00:12, 40.13it/s] 47%|████▋     | 440/938 [00:09<00:11, 45.06it/s] 48%|████▊     | 448/938 [00:09<00:09, 53.57it/s] 49%|████▊     | 455/938 [00:10<00:08, 55.93it/s] 49%|████▉     | 461/938 [00:10<00:08, 54.35it/s] 50%|████▉     | 467/938 [00:10<00:08, 54.07it/s] 50%|█████     | 473/938 [00:10<00:10, 42.80it/s] 51%|█████     | 478/938 [00:10<00:11, 38.46it/s] 52%|█████▏    | 484/938 [00:10<00:10, 42.84it/s] 52%|█████▏    | 490/938 [00:10<00:09, 45.29it/s] 53%|█████▎    | 496/938 [00:11<00:09, 45.94it/s] 53%|█████▎    | 501/938 [00:11<00:10, 42.74it/s] 54%|█████▍    | 506/938 [00:11<00:10, 40.90it/s] 54%|█████▍    | 511/938 [00:11<00:10, 39.56it/s] 55%|█████▌    | 517/938 [00:11<00:09, 43.92it/s] 56%|█████▌    | 524/938 [00:11<00:08, 49.99it/s] 57%|█████▋    | 530/938 [00:11<00:07, 52.54it/s] 57%|█████▋    | 537/938 [00:11<00:07, 56.34it/s] 58%|█████▊    | 545/938 [00:11<00:06, 60.94it/s] 59%|█████▉    | 552/938 [00:12<00:07, 50.97it/s] 59%|█████▉    | 558/938 [00:12<00:07, 50.52it/s] 60%|██████    | 564/938 [00:12<00:07, 51.34it/s] 61%|██████    | 570/938 [00:12<00:07, 52.02it/s] 62%|██████▏   | 577/938 [00:12<00:06, 55.32it/s] 62%|██████▏   | 585/938 [00:12<00:05, 61.50it/s] 63%|██████▎   | 592/938 [00:12<00:05, 62.68it/s] 64%|██████▍   | 601/938 [00:12<00:04, 68.41it/s] 65%|██████▍   | 608/938 [00:13<00:04, 67.12it/s] 66%|██████▌   | 615/938 [00:13<00:05, 60.12it/s] 66%|██████▋   | 622/938 [00:13<00:05, 53.41it/s] 67%|██████▋   | 628/938 [00:13<00:06, 48.18it/s] 68%|██████▊   | 634/938 [00:13<00:06, 48.92it/s] 68%|██████▊   | 640/938 [00:13<00:06, 48.75it/s] 69%|██████▉   | 648/938 [00:13<00:05, 56.37it/s] 70%|██████▉   | 655/938 [00:13<00:05, 56.05it/s] 70%|███████   | 661/938 [00:14<00:05, 53.06it/s] 71%|███████   | 667/938 [00:14<00:05, 48.88it/s] 72%|███████▏  | 673/938 [00:14<00:05, 48.42it/s] 72%|███████▏  | 678/938 [00:14<00:05, 48.20it/s] 73%|███████▎  | 683/938 [00:14<00:05, 45.83it/s] 73%|███████▎  | 688/938 [00:14<00:05, 42.76it/s] 74%|███████▍  | 693/938 [00:14<00:05, 43.57it/s] 74%|███████▍  | 698/938 [00:14<00:05, 44.14it/s] 75%|███████▌  | 704/938 [00:15<00:05, 46.15it/s] 76%|███████▌  | 709/938 [00:15<00:04, 46.56it/s] 76%|███████▌  | 715/938 [00:15<00:04, 47.87it/s] 77%|███████▋  | 720/938 [00:15<00:04, 48.09it/s] 77%|███████▋  | 726/938 [00:15<00:04, 50.48it/s] 78%|███████▊  | 732/938 [00:15<00:04, 48.84it/s] 79%|███████▊  | 737/938 [00:15<00:04, 42.05it/s] 79%|███████▉  | 744/938 [00:15<00:03, 48.88it/s] 80%|████████  | 752/938 [00:16<00:03, 56.76it/s] 81%|████████  | 760/938 [00:16<00:02, 62.23it/s] 82%|████████▏ | 768/938 [00:16<00:02, 66.51it/s] 83%|████████▎ | 775/938 [00:16<00:02, 60.34it/s] 83%|████████▎ | 782/938 [00:16<00:02, 56.21it/s] 84%|████████▍ | 788/938 [00:16<00:02, 52.22it/s] 85%|████████▍ | 794/938 [00:16<00:03, 47.71it/s] 85%|████████▌ | 801/938 [00:16<00:02, 52.38it/s] 86%|████████▌ | 809/938 [00:17<00:02, 57.45it/s] 87%|████████▋ | 817/938 [00:17<00:02, 59.99it/s] 88%|████████▊ | 824/938 [00:17<00:01, 58.58it/s] 88%|████████▊ | 830/938 [00:17<00:01, 57.70it/s] 89%|████████▉ | 836/938 [00:17<00:01, 54.65it/s] 90%|████████▉ | 842/938 [00:17<00:01, 55.04it/s] 91%|█████████ | 849/938 [00:17<00:01, 58.94it/s] 91%|█████████▏| 858/938 [00:17<00:01, 66.88it/s] 92%|█████████▏| 867/938 [00:17<00:00, 72.04it/s] 93%|█████████▎| 875/938 [00:18<00:00, 70.43it/s] 94%|█████████▍| 883/938 [00:18<00:00, 63.40it/s] 95%|█████████▍| 890/938 [00:18<00:00, 64.44it/s] 96%|█████████▌| 898/938 [00:18<00:00, 66.80it/s] 96%|█████████▋| 905/938 [00:18<00:00, 66.90it/s] 97%|█████████▋| 913/938 [00:18<00:00, 68.72it/s] 98%|█████████▊| 921/938 [00:18<00:00, 70.57it/s] 99%|█████████▉| 930/938 [00:18<00:00, 73.92it/s]100%|██████████| 938/938 [00:18<00:00, 70.07it/s]100%|██████████| 938/938 [00:23<00:00, 39.12it/s]
Train Epoch: 2 	Loss: 0.709743 
Moments Accountant gives: (ε = 0.41, δ = 1e-05) for α = 30.20
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:03<00:35,  3.90s/it] 20%|██        | 2/10 [00:04<00:13,  1.71s/it] 30%|███       | 3/10 [00:04<00:07,  1.01s/it] 40%|████      | 4/10 [00:04<00:04,  1.46it/s] 50%|█████     | 5/10 [00:04<00:02,  1.94it/s] 60%|██████    | 6/10 [00:04<00:01,  2.50it/s] 70%|███████   | 7/10 [00:04<00:00,  3.10it/s] 80%|████████  | 8/10 [00:05<00:00,  3.61it/s] 90%|█████████ | 9/10 [00:05<00:00,  3.88it/s]100%|██████████| 10/10 [00:05<00:00,  4.67it/s]100%|██████████| 10/10 [00:05<00:00,  1.77it/s]

Test set: Average loss: 0.0008, Accuracy: 8567/10000 (85.67%)

Training membership inference attack model
Base model accuracy:  0.8567
Random forest model attack results: 
train acc: 0.99985
test acc: 0.5002
total acc: 0.9284714285714286
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.56it/s] 20%|██        | 2/10 [00:00<00:02,  2.80it/s] 30%|███       | 3/10 [00:00<00:01,  3.52it/s] 40%|████      | 4/10 [00:01<00:01,  4.26it/s] 50%|█████     | 5/10 [00:01<00:01,  4.78it/s] 60%|██████    | 6/10 [00:01<00:00,  4.83it/s] 70%|███████   | 7/10 [00:01<00:00,  5.24it/s] 80%|████████  | 8/10 [00:01<00:00,  5.00it/s] 90%|█████████ | 9/10 [00:02<00:00,  5.17it/s]100%|██████████| 10/10 [00:02<00:00,  5.91it/s]100%|██████████| 10/10 [00:02<00:00,  4.24it/s]

Test set: Average loss: 0.0008, Accuracy: 8567/10000 (85.67%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:02<33:43,  2.16s/it]  1%|          | 9/938 [00:02<02:52,  5.37it/s]  2%|▏         | 16/938 [00:02<01:27, 10.60it/s]  3%|▎         | 24/938 [00:02<00:51, 17.78it/s]  3%|▎         | 31/938 [00:02<00:37, 24.49it/s]  4%|▍         | 39/938 [00:02<00:27, 32.76it/s]  5%|▌         | 47/938 [00:02<00:21, 40.73it/s]  6%|▌         | 55/938 [00:02<00:18, 47.78it/s]  7%|▋         | 63/938 [00:03<00:16, 52.47it/s]  8%|▊         | 71/938 [00:03<00:14, 58.49it/s]  8%|▊         | 79/938 [00:03<00:13, 62.78it/s]  9%|▉         | 87/938 [00:03<00:13, 64.69it/s] 10%|█         | 95/938 [00:03<00:12, 64.98it/s] 11%|█         | 103/938 [00:03<00:12, 68.47it/s] 12%|█▏        | 112/938 [00:03<00:11, 72.19it/s] 13%|█▎        | 120/938 [00:03<00:11, 71.28it/s] 14%|█▎        | 128/938 [00:03<00:11, 72.66it/s] 15%|█▍        | 137/938 [00:04<00:10, 76.23it/s] 16%|█▌        | 147/938 [00:04<00:09, 80.45it/s] 17%|█▋        | 156/938 [00:04<00:09, 78.84it/s] 17%|█▋        | 164/938 [00:04<00:11, 69.08it/s] 18%|█▊        | 172/938 [00:04<00:11, 66.76it/s] 19%|█▉        | 179/938 [00:04<00:11, 66.17it/s] 20%|██        | 188/938 [00:04<00:10, 69.90it/s] 21%|██        | 196/938 [00:04<00:10, 72.35it/s] 22%|██▏       | 205/938 [00:04<00:09, 75.33it/s] 23%|██▎       | 213/938 [00:05<00:10, 71.46it/s] 24%|██▎       | 221/938 [00:05<00:10, 66.85it/s] 24%|██▍       | 229/938 [00:05<00:10, 68.16it/s] 25%|██▌       | 237/938 [00:05<00:10, 69.91it/s] 26%|██▌       | 245/938 [00:05<00:09, 69.87it/s] 27%|██▋       | 253/938 [00:05<00:09, 70.53it/s] 28%|██▊       | 261/938 [00:05<00:09, 71.03it/s] 29%|██▉       | 270/938 [00:05<00:09, 73.80it/s] 30%|██▉       | 278/938 [00:05<00:08, 73.49it/s] 30%|███       | 286/938 [00:06<00:08, 74.32it/s] 31%|███▏      | 294/938 [00:06<00:08, 75.62it/s] 32%|███▏      | 302/938 [00:06<00:08, 76.02it/s] 33%|███▎      | 310/938 [00:06<00:08, 76.90it/s] 34%|███▍      | 318/938 [00:06<00:08, 76.76it/s] 35%|███▍      | 326/938 [00:06<00:08, 75.77it/s] 36%|███▌      | 334/938 [00:06<00:08, 74.30it/s] 37%|███▋      | 343/938 [00:06<00:07, 76.89it/s] 38%|███▊      | 352/938 [00:06<00:07, 79.56it/s] 38%|███▊      | 360/938 [00:07<00:07, 76.40it/s] 39%|███▉      | 368/938 [00:07<00:07, 76.00it/s] 40%|████      | 376/938 [00:07<00:07, 74.13it/s] 41%|████      | 384/938 [00:07<00:07, 75.16it/s] 42%|████▏     | 393/938 [00:07<00:07, 77.43it/s] 43%|████▎     | 402/938 [00:07<00:06, 79.17it/s] 44%|████▎     | 410/938 [00:07<00:06, 78.27it/s] 45%|████▍     | 419/938 [00:07<00:06, 78.31it/s] 46%|████▌     | 427/938 [00:07<00:07, 72.35it/s] 46%|████▋     | 435/938 [00:08<00:07, 65.34it/s] 47%|████▋     | 442/938 [00:08<00:08, 59.99it/s] 48%|████▊     | 449/938 [00:08<00:08, 56.60it/s] 49%|████▊     | 456/938 [00:08<00:08, 59.75it/s] 49%|████▉     | 463/938 [00:08<00:08, 59.27it/s] 50%|█████     | 470/938 [00:08<00:08, 55.18it/s] 51%|█████     | 477/938 [00:08<00:08, 56.82it/s] 52%|█████▏    | 484/938 [00:08<00:07, 59.49it/s] 52%|█████▏    | 491/938 [00:09<00:07, 56.90it/s] 53%|█████▎    | 498/938 [00:09<00:07, 58.50it/s] 54%|█████▎    | 504/938 [00:09<00:07, 56.62it/s] 55%|█████▍    | 512/938 [00:09<00:06, 60.93it/s] 55%|█████▌    | 520/938 [00:09<00:06, 65.22it/s] 56%|█████▋    | 528/938 [00:09<00:05, 69.23it/s] 57%|█████▋    | 536/938 [00:09<00:05, 70.85it/s] 58%|█████▊    | 544/938 [00:09<00:05, 72.11it/s] 59%|█████▉    | 552/938 [00:09<00:05, 68.64it/s] 60%|█████▉    | 559/938 [00:10<00:05, 68.99it/s] 60%|██████    | 567/938 [00:10<00:05, 70.92it/s] 61%|██████▏   | 576/938 [00:10<00:04, 75.26it/s] 62%|██████▏   | 585/938 [00:10<00:04, 78.47it/s] 63%|██████▎   | 594/938 [00:10<00:04, 79.18it/s] 64%|██████▍   | 602/938 [00:10<00:04, 75.51it/s] 65%|██████▌   | 610/938 [00:10<00:04, 71.88it/s] 66%|██████▌   | 619/938 [00:10<00:04, 76.00it/s] 67%|██████▋   | 628/938 [00:10<00:03, 78.31it/s] 68%|██████▊   | 637/938 [00:11<00:03, 80.19it/s] 69%|██████▉   | 646/938 [00:11<00:03, 80.38it/s] 70%|██████▉   | 655/938 [00:11<00:03, 78.99it/s] 71%|███████   | 663/938 [00:11<00:03, 74.32it/s] 72%|███████▏  | 671/938 [00:11<00:03, 66.79it/s] 72%|███████▏  | 679/938 [00:11<00:03, 68.87it/s] 73%|███████▎  | 687/938 [00:11<00:03, 67.36it/s] 74%|███████▍  | 696/938 [00:11<00:03, 71.36it/s] 75%|███████▌  | 705/938 [00:12<00:03, 74.49it/s] 76%|███████▌  | 714/938 [00:12<00:02, 76.38it/s] 77%|███████▋  | 722/938 [00:12<00:02, 77.31it/s] 78%|███████▊  | 730/938 [00:12<00:02, 75.86it/s] 79%|███████▊  | 738/938 [00:12<00:02, 73.57it/s] 80%|███████▉  | 747/938 [00:12<00:02, 76.13it/s] 80%|████████  | 755/938 [00:12<00:02, 76.76it/s] 81%|████████▏ | 763/938 [00:12<00:02, 77.28it/s] 82%|████████▏ | 772/938 [00:12<00:02, 78.75it/s] 83%|████████▎ | 780/938 [00:13<00:02, 71.77it/s] 84%|████████▍ | 788/938 [00:13<00:02, 70.95it/s] 85%|████████▍ | 796/938 [00:13<00:01, 73.28it/s] 86%|████████▌ | 805/938 [00:13<00:01, 75.78it/s] 87%|████████▋ | 814/938 [00:13<00:01, 77.43it/s] 88%|████████▊ | 822/938 [00:13<00:01, 77.98it/s] 88%|████████▊ | 830/938 [00:13<00:01, 75.68it/s] 89%|████████▉ | 838/938 [00:13<00:01, 75.11it/s] 90%|█████████ | 847/938 [00:13<00:01, 77.48it/s] 91%|█████████ | 855/938 [00:14<00:01, 77.25it/s] 92%|█████████▏| 863/938 [00:14<00:00, 75.65it/s] 93%|█████████▎| 871/938 [00:14<00:00, 74.98it/s] 94%|█████████▍| 880/938 [00:14<00:00, 77.09it/s] 95%|█████████▍| 889/938 [00:14<00:00, 78.40it/s] 96%|█████████▌| 898/938 [00:14<00:00, 79.54it/s] 97%|█████████▋| 906/938 [00:14<00:00, 71.90it/s] 97%|█████████▋| 914/938 [00:14<00:00, 70.44it/s] 98%|█████████▊| 923/938 [00:14<00:00, 74.26it/s] 99%|█████████▉| 931/938 [00:15<00:00, 72.97it/s]100%|██████████| 938/938 [00:15<00:00, 61.41it/s]
Train Epoch: 1 	Loss: 1.024637 
Moments Accountant gives: (ε = 0.23, δ = 1e-05) for α = 54.20
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.64it/s] 20%|██        | 2/10 [00:00<00:02,  2.86it/s] 30%|███       | 3/10 [00:00<00:01,  3.83it/s] 40%|████      | 4/10 [00:01<00:01,  4.52it/s] 50%|█████     | 5/10 [00:01<00:00,  5.07it/s] 60%|██████    | 6/10 [00:01<00:00,  5.40it/s] 70%|███████   | 7/10 [00:01<00:00,  5.61it/s] 80%|████████  | 8/10 [00:01<00:00,  5.44it/s] 90%|█████████ | 9/10 [00:01<00:00,  5.63it/s]100%|██████████| 10/10 [00:02<00:00,  6.32it/s]100%|██████████| 10/10 [00:02<00:00,  4.51it/s]

Test set: Average loss: 0.0010, Accuracy: 7963/10000 (79.63%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<03:52,  4.03it/s]  1%|          | 10/938 [00:00<00:27, 34.17it/s]  2%|▏         | 18/938 [00:00<00:18, 49.36it/s]  3%|▎         | 26/938 [00:00<00:15, 59.15it/s]  4%|▎         | 33/938 [00:00<00:14, 62.04it/s]  4%|▍         | 41/938 [00:00<00:13, 65.50it/s]  5%|▌         | 50/938 [00:00<00:12, 70.50it/s]  6%|▋         | 59/938 [00:00<00:11, 75.00it/s]  7%|▋         | 68/938 [00:01<00:11, 77.74it/s]  8%|▊         | 76/938 [00:01<00:11, 76.47it/s]  9%|▉         | 84/938 [00:01<00:15, 56.01it/s] 10%|▉         | 91/938 [00:01<00:19, 43.34it/s] 10%|█         | 97/938 [00:01<00:21, 39.01it/s] 11%|█         | 102/938 [00:02<00:23, 35.45it/s] 11%|█▏        | 107/938 [00:02<00:25, 32.78it/s] 12%|█▏        | 111/938 [00:02<00:26, 31.15it/s] 12%|█▏        | 115/938 [00:02<00:27, 30.45it/s] 13%|█▎        | 119/938 [00:02<00:25, 31.64it/s] 13%|█▎        | 123/938 [00:02<00:24, 33.30it/s] 14%|█▎        | 127/938 [00:02<00:24, 33.77it/s] 14%|█▍        | 131/938 [00:03<00:23, 33.83it/s] 14%|█▍        | 135/938 [00:03<00:23, 33.52it/s] 15%|█▍        | 139/938 [00:03<00:23, 34.59it/s] 15%|█▌        | 143/938 [00:03<00:22, 35.90it/s] 16%|█▌        | 147/938 [00:03<00:21, 36.95it/s] 16%|█▌        | 151/938 [00:03<00:20, 37.55it/s] 17%|█▋        | 155/938 [00:03<00:20, 37.79it/s] 17%|█▋        | 159/938 [00:03<00:20, 37.13it/s] 17%|█▋        | 163/938 [00:03<00:21, 36.24it/s] 18%|█▊        | 167/938 [00:03<00:21, 35.13it/s] 18%|█▊        | 171/938 [00:04<00:21, 35.28it/s] 19%|█▉        | 176/938 [00:04<00:20, 37.17it/s] 19%|█▉        | 181/938 [00:04<00:19, 38.48it/s] 20%|█▉        | 186/938 [00:04<00:18, 39.69it/s] 20%|██        | 191/938 [00:04<00:18, 40.77it/s] 21%|██        | 197/938 [00:04<00:16, 45.43it/s] 22%|██▏       | 204/938 [00:04<00:14, 50.21it/s] 23%|██▎       | 212/938 [00:04<00:12, 56.69it/s] 23%|██▎       | 220/938 [00:05<00:11, 61.32it/s] 24%|██▍       | 228/938 [00:05<00:10, 64.93it/s] 25%|██▌       | 236/938 [00:05<00:10, 67.27it/s] 26%|██▌       | 243/938 [00:05<00:10, 65.20it/s] 27%|██▋       | 250/938 [00:05<00:10, 65.04it/s] 28%|██▊       | 258/938 [00:05<00:09, 68.95it/s] 28%|██▊       | 267/938 [00:05<00:09, 72.73it/s] 29%|██▉       | 276/938 [00:05<00:08, 75.32it/s] 30%|███       | 285/938 [00:05<00:08, 77.00it/s] 31%|███       | 293/938 [00:06<00:08, 73.27it/s] 32%|███▏      | 301/938 [00:06<00:08, 73.15it/s] 33%|███▎      | 309/938 [00:06<00:08, 73.62it/s] 34%|███▍      | 318/938 [00:06<00:08, 77.15it/s] 35%|███▍      | 326/938 [00:06<00:08, 75.59it/s] 36%|███▌      | 334/938 [00:06<00:08, 74.54it/s] 37%|███▋      | 343/938 [00:06<00:07, 77.25it/s] 37%|███▋      | 351/938 [00:06<00:07, 77.94it/s] 38%|███▊      | 360/938 [00:06<00:07, 80.49it/s] 39%|███▉      | 369/938 [00:06<00:07, 79.25it/s] 40%|████      | 377/938 [00:07<00:07, 75.62it/s] 41%|████      | 385/938 [00:07<00:07, 69.82it/s] 42%|████▏     | 393/938 [00:07<00:08, 67.77it/s] 43%|████▎     | 400/938 [00:07<00:08, 67.23it/s] 43%|████▎     | 408/938 [00:07<00:07, 67.94it/s] 44%|████▍     | 417/938 [00:07<00:07, 71.84it/s] 45%|████▌     | 426/938 [00:07<00:06, 74.70it/s] 46%|████▋     | 435/938 [00:07<00:06, 78.02it/s] 47%|████▋     | 443/938 [00:08<00:06, 74.54it/s] 48%|████▊     | 451/938 [00:08<00:06, 70.58it/s] 49%|████▉     | 459/938 [00:08<00:06, 72.93it/s] 50%|████▉     | 468/938 [00:08<00:06, 76.28it/s] 51%|█████     | 476/938 [00:08<00:06, 75.79it/s] 52%|█████▏    | 484/938 [00:08<00:06, 73.91it/s] 52%|█████▏    | 492/938 [00:08<00:06, 73.28it/s] 53%|█████▎    | 500/938 [00:08<00:05, 74.94it/s] 54%|█████▍    | 508/938 [00:08<00:05, 74.93it/s] 55%|█████▌    | 516/938 [00:09<00:05, 76.09it/s] 56%|█████▌    | 524/938 [00:09<00:05, 75.54it/s] 57%|█████▋    | 532/938 [00:09<00:05, 74.21it/s] 58%|█████▊    | 540/938 [00:09<00:05, 73.68it/s] 59%|█████▊    | 549/938 [00:09<00:05, 75.76it/s] 59%|█████▉    | 557/938 [00:09<00:04, 76.59it/s] 60%|██████    | 565/938 [00:09<00:04, 76.03it/s] 61%|██████    | 573/938 [00:09<00:04, 73.65it/s] 62%|██████▏   | 581/938 [00:09<00:05, 70.63it/s] 63%|██████▎   | 590/938 [00:10<00:04, 74.76it/s] 64%|██████▍   | 599/938 [00:10<00:04, 77.31it/s] 65%|██████▍   | 608/938 [00:10<00:04, 78.60it/s] 66%|██████▌   | 616/938 [00:10<00:04, 76.64it/s] 67%|██████▋   | 624/938 [00:10<00:04, 72.00it/s] 67%|██████▋   | 633/938 [00:10<00:04, 75.16it/s] 68%|██████▊   | 642/938 [00:10<00:03, 77.52it/s] 69%|██████▉   | 651/938 [00:10<00:03, 79.94it/s] 70%|███████   | 660/938 [00:10<00:03, 76.78it/s] 71%|███████   | 668/938 [00:11<00:03, 74.45it/s] 72%|███████▏  | 676/938 [00:11<00:03, 72.14it/s] 73%|███████▎  | 685/938 [00:11<00:03, 76.48it/s] 74%|███████▍  | 694/938 [00:11<00:03, 78.37it/s] 75%|███████▍  | 703/938 [00:11<00:02, 80.22it/s] 76%|███████▌  | 712/938 [00:11<00:02, 77.17it/s] 77%|███████▋  | 720/938 [00:11<00:02, 74.47it/s] 78%|███████▊  | 728/938 [00:11<00:02, 75.44it/s] 79%|███████▊  | 737/938 [00:11<00:02, 76.57it/s] 80%|███████▉  | 746/938 [00:12<00:02, 80.07it/s] 80%|████████  | 755/938 [00:12<00:02, 79.55it/s] 81%|████████▏ | 764/938 [00:12<00:02, 81.16it/s] 82%|████████▏ | 773/938 [00:12<00:02, 80.75it/s] 83%|████████▎ | 782/938 [00:12<00:01, 78.12it/s] 84%|████████▍ | 791/938 [00:12<00:01, 79.88it/s] 85%|████████▌ | 800/938 [00:12<00:01, 79.45it/s] 86%|████████▌ | 808/938 [00:12<00:01, 71.24it/s] 87%|████████▋ | 817/938 [00:12<00:01, 74.05it/s] 88%|████████▊ | 825/938 [00:13<00:01, 75.59it/s] 89%|████████▉ | 833/938 [00:13<00:01, 74.71it/s] 90%|████████▉ | 841/938 [00:13<00:01, 75.69it/s] 91%|█████████ | 849/938 [00:13<00:01, 76.65it/s] 91%|█████████▏| 858/938 [00:13<00:01, 78.63it/s] 92%|█████████▏| 867/938 [00:13<00:00, 79.73it/s] 93%|█████████▎| 875/938 [00:13<00:00, 79.38it/s] 94%|█████████▍| 884/938 [00:13<00:00, 80.12it/s] 95%|█████████▌| 893/938 [00:13<00:00, 72.01it/s] 96%|█████████▌| 901/938 [00:14<00:00, 72.07it/s] 97%|█████████▋| 910/938 [00:14<00:00, 74.81it/s] 98%|█████████▊| 918/938 [00:14<00:00, 75.58it/s] 99%|█████████▊| 926/938 [00:14<00:00, 72.02it/s]100%|█████████▉| 934/938 [00:14<00:00, 72.75it/s]100%|██████████| 938/938 [00:14<00:00, 63.74it/s]
Train Epoch: 2 	Loss: 1.099034 
Moments Accountant gives: (ε = 0.23, δ = 1e-05) for α = 54.10
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.57it/s] 20%|██        | 2/10 [00:00<00:03,  2.57it/s] 30%|███       | 3/10 [00:01<00:02,  2.74it/s] 40%|████      | 4/10 [00:01<00:01,  3.28it/s] 50%|█████     | 5/10 [00:01<00:01,  3.51it/s] 60%|██████    | 6/10 [00:01<00:01,  3.61it/s] 70%|███████   | 7/10 [00:02<00:00,  3.72it/s] 80%|████████  | 8/10 [00:02<00:00,  4.07it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.35it/s]100%|██████████| 10/10 [00:02<00:00,  4.75it/s]100%|██████████| 10/10 [00:02<00:00,  3.43it/s]

Test set: Average loss: 0.0016, Accuracy: 7753/10000 (77.53%)

Training membership inference attack model
Base model accuracy:  0.7753
Random forest model attack results: 
train acc: 0.9998833333333333
test acc: 0.5001
total acc: 0.9284857142857142
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:07,  1.22it/s] 20%|██        | 2/10 [00:01<00:03,  2.13it/s] 30%|███       | 3/10 [00:01<00:02,  3.02it/s] 40%|████      | 4/10 [00:01<00:01,  3.84it/s] 50%|█████     | 5/10 [00:01<00:01,  4.17it/s] 60%|██████    | 6/10 [00:01<00:00,  4.12it/s] 70%|███████   | 7/10 [00:01<00:00,  4.60it/s] 80%|████████  | 8/10 [00:02<00:00,  4.36it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.50it/s]100%|██████████| 10/10 [00:02<00:00,  4.84it/s]100%|██████████| 10/10 [00:02<00:00,  3.56it/s]

Test set: Average loss: 0.0016, Accuracy: 7753/10000 (77.53%)

(60000, 1, 28, 28)
(10000, 1, 28, 28)
  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:02<33:40,  2.16s/it]  1%|          | 9/938 [00:02<02:52,  5.40it/s]  2%|▏         | 17/938 [00:02<01:20, 11.41it/s]  3%|▎         | 25/938 [00:02<00:49, 18.43it/s]  3%|▎         | 32/938 [00:02<00:36, 24.72it/s]  4%|▍         | 40/938 [00:02<00:27, 33.11it/s]  5%|▌         | 48/938 [00:02<00:21, 40.81it/s]  6%|▌         | 56/938 [00:02<00:18, 48.50it/s]  7%|▋         | 64/938 [00:03<00:15, 54.67it/s]  8%|▊         | 72/938 [00:03<00:14, 58.84it/s]  9%|▊         | 80/938 [00:03<00:13, 62.64it/s]  9%|▉         | 89/938 [00:03<00:12, 68.52it/s] 11%|█         | 99/938 [00:03<00:11, 74.95it/s] 12%|█▏        | 108/938 [00:03<00:10, 77.15it/s] 12%|█▏        | 117/938 [00:03<00:10, 78.17it/s] 13%|█▎        | 126/938 [00:03<00:10, 74.03it/s] 14%|█▍        | 134/938 [00:03<00:10, 74.70it/s] 15%|█▌        | 142/938 [00:04<00:11, 68.65it/s] 16%|█▌        | 150/938 [00:04<00:11, 65.98it/s] 17%|█▋        | 157/938 [00:04<00:12, 63.40it/s] 17%|█▋        | 164/938 [00:04<00:12, 62.24it/s] 18%|█▊        | 171/938 [00:04<00:12, 61.23it/s] 19%|█▉        | 178/938 [00:04<00:12, 63.12it/s] 20%|█▉        | 187/938 [00:04<00:10, 69.65it/s] 21%|██        | 195/938 [00:04<00:10, 70.62it/s] 22%|██▏       | 203/938 [00:04<00:10, 70.85it/s] 23%|██▎       | 212/938 [00:05<00:09, 73.57it/s] 23%|██▎       | 220/938 [00:05<00:10, 69.94it/s] 24%|██▍       | 228/938 [00:05<00:10, 68.09it/s] 25%|██▌       | 235/938 [00:05<00:10, 67.66it/s] 26%|██▌       | 243/938 [00:05<00:10, 68.90it/s] 27%|██▋       | 250/938 [00:05<00:10, 67.14it/s] 28%|██▊       | 258/938 [00:05<00:09, 70.48it/s] 28%|██▊       | 266/938 [00:05<00:10, 61.16it/s] 29%|██▉       | 273/938 [00:06<00:11, 59.13it/s] 30%|██▉       | 280/938 [00:06<00:11, 56.85it/s] 30%|███       | 286/938 [00:06<00:11, 56.12it/s] 31%|███       | 292/938 [00:06<00:11, 54.70it/s] 32%|███▏      | 298/938 [00:06<00:11, 55.95it/s] 32%|███▏      | 304/938 [00:06<00:11, 56.42it/s] 33%|███▎      | 311/938 [00:06<00:10, 59.02it/s] 34%|███▍      | 320/938 [00:06<00:09, 65.78it/s] 35%|███▌      | 329/938 [00:06<00:08, 71.86it/s] 36%|███▌      | 337/938 [00:07<00:08, 72.54it/s] 37%|███▋      | 345/938 [00:07<00:08, 73.12it/s] 38%|███▊      | 354/938 [00:07<00:07, 76.36it/s] 39%|███▊      | 363/938 [00:07<00:07, 78.22it/s] 40%|███▉      | 371/938 [00:07<00:07, 78.35it/s] 41%|████      | 380/938 [00:07<00:07, 79.45it/s] 41%|████▏     | 388/938 [00:07<00:07, 76.61it/s] 42%|████▏     | 396/938 [00:07<00:07, 75.00it/s] 43%|████▎     | 405/938 [00:07<00:06, 78.67it/s] 44%|████▍     | 413/938 [00:08<00:06, 79.02it/s] 45%|████▍     | 421/938 [00:08<00:06, 79.16it/s] 46%|████▌     | 429/938 [00:08<00:06, 76.56it/s] 47%|████▋     | 437/938 [00:08<00:06, 76.23it/s] 48%|████▊     | 446/938 [00:08<00:06, 79.34it/s] 49%|████▊     | 455/938 [00:08<00:05, 80.54it/s] 49%|████▉     | 464/938 [00:08<00:05, 82.02it/s] 50%|█████     | 473/938 [00:08<00:05, 78.94it/s] 51%|█████▏    | 481/938 [00:08<00:05, 77.20it/s] 52%|█████▏    | 490/938 [00:08<00:05, 79.89it/s] 53%|█████▎    | 499/938 [00:09<00:05, 82.18it/s] 54%|█████▍    | 508/938 [00:09<00:05, 79.35it/s] 55%|█████▌    | 516/938 [00:09<00:05, 78.99it/s] 56%|█████▌    | 524/938 [00:09<00:05, 75.07it/s] 57%|█████▋    | 532/938 [00:09<00:05, 71.03it/s] 58%|█████▊    | 541/938 [00:09<00:05, 75.99it/s] 59%|█████▊    | 550/938 [00:09<00:04, 78.12it/s] 59%|█████▉    | 558/938 [00:09<00:05, 74.66it/s] 60%|██████    | 566/938 [00:10<00:05, 72.03it/s] 61%|██████▏   | 575/938 [00:10<00:04, 75.72it/s] 62%|██████▏   | 584/938 [00:10<00:04, 79.46it/s] 63%|██████▎   | 593/938 [00:10<00:04, 81.40it/s] 64%|██████▍   | 602/938 [00:10<00:04, 79.31it/s] 65%|██████▌   | 610/938 [00:10<00:04, 77.79it/s] 66%|██████▌   | 619/938 [00:10<00:04, 78.67it/s] 67%|██████▋   | 627/938 [00:10<00:04, 74.09it/s] 68%|██████▊   | 635/938 [00:10<00:04, 70.01it/s] 69%|██████▊   | 643/938 [00:11<00:04, 72.46it/s] 69%|██████▉   | 651/938 [00:11<00:03, 73.48it/s] 70%|███████   | 659/938 [00:11<00:03, 73.91it/s] 71%|███████▏  | 669/938 [00:11<00:03, 79.20it/s] 72%|███████▏  | 678/938 [00:11<00:03, 81.52it/s] 73%|███████▎  | 688/938 [00:11<00:02, 84.65it/s] 74%|███████▍  | 697/938 [00:11<00:03, 70.40it/s] 75%|███████▌  | 705/938 [00:11<00:03, 71.50it/s] 76%|███████▌  | 715/938 [00:11<00:02, 76.85it/s] 77%|███████▋  | 724/938 [00:12<00:02, 79.97it/s] 78%|███████▊  | 733/938 [00:12<00:02, 75.91it/s] 79%|███████▉  | 741/938 [00:12<00:02, 75.03it/s] 80%|███████▉  | 750/938 [00:12<00:02, 78.60it/s] 81%|████████  | 759/938 [00:12<00:02, 81.30it/s] 82%|████████▏ | 768/938 [00:12<00:02, 82.08it/s] 83%|████████▎ | 777/938 [00:12<00:01, 82.64it/s] 84%|████████▍ | 786/938 [00:12<00:01, 79.00it/s] 85%|████████▍ | 794/938 [00:12<00:01, 78.92it/s] 86%|████████▌ | 803/938 [00:13<00:01, 78.74it/s] 87%|████████▋ | 813/938 [00:13<00:01, 83.32it/s] 88%|████████▊ | 822/938 [00:13<00:01, 82.73it/s] 89%|████████▊ | 831/938 [00:13<00:01, 78.83it/s] 89%|████████▉ | 839/938 [00:13<00:01, 77.46it/s] 90%|█████████ | 847/938 [00:13<00:01, 75.16it/s] 91%|█████████▏| 856/938 [00:13<00:01, 79.07it/s] 92%|█████████▏| 864/938 [00:13<00:00, 78.37it/s] 93%|█████████▎| 872/938 [00:13<00:00, 77.43it/s] 94%|█████████▍| 880/938 [00:14<00:00, 77.92it/s] 95%|█████████▍| 888/938 [00:14<00:00, 75.22it/s] 96%|█████████▌| 896/938 [00:14<00:00, 73.20it/s] 96%|█████████▋| 904/938 [00:14<00:00, 71.08it/s] 97%|█████████▋| 912/938 [00:14<00:00, 70.30it/s] 98%|█████████▊| 920/938 [00:14<00:00, 70.10it/s] 99%|█████████▉| 928/938 [00:14<00:00, 69.82it/s]100%|█████████▉| 936/938 [00:14<00:00, 69.69it/s]100%|██████████| 938/938 [00:15<00:00, 62.48it/s]
Train Epoch: 1 	Loss: 1.329403 
Moments Accountant gives: (ε = 0.12, δ = 1e-05) for α = 99.00
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:06,  1.45it/s] 20%|██        | 2/10 [00:00<00:02,  2.68it/s] 30%|███       | 3/10 [00:00<00:01,  3.68it/s] 40%|████      | 4/10 [00:01<00:01,  4.54it/s] 50%|█████     | 5/10 [00:01<00:00,  5.11it/s] 60%|██████    | 6/10 [00:01<00:00,  5.66it/s] 70%|███████   | 7/10 [00:01<00:00,  6.02it/s] 80%|████████  | 8/10 [00:01<00:00,  6.19it/s] 90%|█████████ | 9/10 [00:01<00:00,  6.29it/s]100%|██████████| 10/10 [00:01<00:00,  7.00it/s]100%|██████████| 10/10 [00:02<00:00,  4.70it/s]

Test set: Average loss: 0.0020, Accuracy: 6760/10000 (67.60%)

  0%|          | 0/938 [00:00<?, ?it/s]  0%|          | 1/938 [00:00<03:21,  4.65it/s]  1%|          | 10/938 [00:00<00:24, 37.76it/s]  2%|▏         | 18/938 [00:00<00:17, 52.41it/s]  3%|▎         | 26/938 [00:00<00:15, 59.23it/s]  4%|▎         | 35/938 [00:00<00:13, 68.80it/s]  5%|▍         | 44/938 [00:00<00:12, 73.99it/s]  6%|▌         | 53/938 [00:00<00:11, 77.98it/s]  7%|▋         | 62/938 [00:00<00:11, 78.24it/s]  8%|▊         | 71/938 [00:01<00:11, 78.21it/s]  9%|▊         | 80/938 [00:01<00:10, 79.49it/s] 10%|▉         | 90/938 [00:01<00:10, 82.89it/s] 11%|█         | 99/938 [00:01<00:10, 83.74it/s] 12%|█▏        | 108/938 [00:01<00:09, 83.39it/s] 12%|█▏        | 117/938 [00:01<00:10, 81.11it/s] 14%|█▎        | 127/938 [00:01<00:09, 85.19it/s] 14%|█▍        | 136/938 [00:01<00:09, 84.40it/s] 15%|█▌        | 145/938 [00:01<00:09, 85.76it/s] 16%|█▋        | 154/938 [00:02<00:09, 84.13it/s] 17%|█▋        | 164/938 [00:02<00:09, 84.46it/s] 19%|█▊        | 174/938 [00:02<00:08, 85.92it/s] 20%|█▉        | 183/938 [00:02<00:08, 86.03it/s] 20%|██        | 192/938 [00:02<00:09, 81.31it/s] 21%|██▏       | 201/938 [00:02<00:08, 82.11it/s] 22%|██▏       | 210/938 [00:02<00:08, 84.24it/s] 23%|██▎       | 220/938 [00:02<00:08, 86.35it/s] 24%|██▍       | 229/938 [00:02<00:08, 81.39it/s] 25%|██▌       | 238/938 [00:03<00:08, 80.46it/s] 26%|██▋       | 248/938 [00:03<00:08, 83.29it/s] 27%|██▋       | 257/938 [00:03<00:08, 83.60it/s] 28%|██▊       | 266/938 [00:03<00:07, 84.58it/s] 29%|██▉       | 275/938 [00:03<00:08, 82.16it/s] 30%|███       | 284/938 [00:03<00:07, 83.02it/s] 31%|███▏      | 294/938 [00:03<00:07, 85.63it/s] 32%|███▏      | 303/938 [00:03<00:07, 86.04it/s] 33%|███▎      | 312/938 [00:03<00:07, 82.15it/s] 34%|███▍      | 321/938 [00:04<00:07, 81.28it/s] 35%|███▌      | 330/938 [00:04<00:07, 83.03it/s] 36%|███▌      | 340/938 [00:04<00:06, 85.81it/s] 37%|███▋      | 349/938 [00:04<00:06, 85.18it/s] 38%|███▊      | 358/938 [00:04<00:07, 80.81it/s] 39%|███▉      | 367/938 [00:04<00:07, 78.02it/s] 40%|████      | 376/938 [00:04<00:06, 81.10it/s] 41%|████      | 385/938 [00:04<00:06, 82.03it/s] 42%|████▏     | 394/938 [00:04<00:06, 83.06it/s] 43%|████▎     | 403/938 [00:05<00:06, 80.00it/s] 44%|████▍     | 412/938 [00:05<00:06, 80.17it/s] 45%|████▍     | 422/938 [00:05<00:06, 83.49it/s] 46%|████▌     | 431/938 [00:05<00:06, 83.94it/s] 47%|████▋     | 441/938 [00:05<00:05, 85.76it/s] 48%|████▊     | 450/938 [00:05<00:05, 82.10it/s] 49%|████▉     | 459/938 [00:05<00:05, 80.89it/s] 50%|████▉     | 468/938 [00:05<00:05, 78.42it/s] 51%|█████     | 476/938 [00:05<00:06, 76.51it/s] 52%|█████▏    | 484/938 [00:06<00:06, 69.95it/s] 52%|█████▏    | 492/938 [00:06<00:06, 68.57it/s] 53%|█████▎    | 500/938 [00:06<00:06, 69.62it/s] 54%|█████▍    | 508/938 [00:06<00:06, 69.32it/s] 55%|█████▍    | 515/938 [00:06<00:06, 65.76it/s] 56%|█████▌    | 522/938 [00:06<00:06, 64.24it/s] 57%|█████▋    | 532/938 [00:06<00:05, 71.84it/s] 58%|█████▊    | 541/938 [00:06<00:05, 75.79it/s] 59%|█████▊    | 551/938 [00:07<00:04, 79.89it/s] 60%|█████▉    | 560/938 [00:07<00:04, 79.78it/s] 61%|██████    | 569/938 [00:07<00:04, 79.97it/s] 62%|██████▏   | 579/938 [00:07<00:04, 83.54it/s] 63%|██████▎   | 588/938 [00:07<00:04, 80.50it/s] 64%|██████▎   | 597/938 [00:07<00:04, 81.82it/s] 65%|██████▍   | 606/938 [00:07<00:04, 79.78it/s] 66%|██████▌   | 616/938 [00:07<00:03, 83.15it/s] 67%|██████▋   | 625/938 [00:07<00:03, 83.69it/s] 68%|██████▊   | 635/938 [00:08<00:03, 86.12it/s] 69%|██████▊   | 644/938 [00:08<00:03, 82.88it/s] 70%|██████▉   | 653/938 [00:08<00:03, 81.29it/s] 71%|███████   | 663/938 [00:08<00:03, 85.37it/s] 72%|███████▏  | 672/938 [00:08<00:03, 85.83it/s] 73%|███████▎  | 681/938 [00:08<00:02, 85.94it/s] 74%|███████▎  | 690/938 [00:08<00:03, 81.36it/s] 75%|███████▍  | 699/938 [00:08<00:02, 82.52it/s] 75%|███████▌  | 708/938 [00:08<00:02, 83.91it/s] 77%|███████▋  | 718/938 [00:09<00:02, 86.05it/s] 78%|███████▊  | 727/938 [00:09<00:02, 86.42it/s] 78%|███████▊  | 736/938 [00:09<00:02, 84.04it/s] 79%|███████▉  | 745/938 [00:09<00:02, 85.34it/s] 80%|████████  | 754/938 [00:09<00:02, 86.54it/s] 81%|████████▏ | 763/938 [00:09<00:02, 84.54it/s] 82%|████████▏ | 772/938 [00:09<00:01, 85.88it/s] 83%|████████▎ | 781/938 [00:09<00:01, 86.74it/s] 84%|████████▍ | 791/938 [00:09<00:01, 87.94it/s] 85%|████████▌ | 800/938 [00:09<00:01, 87.55it/s] 86%|████████▌ | 809/938 [00:10<00:01, 87.22it/s] 87%|████████▋ | 818/938 [00:10<00:01, 87.46it/s] 88%|████████▊ | 827/938 [00:10<00:01, 85.70it/s] 89%|████████▉ | 836/938 [00:10<00:01, 81.25it/s] 90%|█████████ | 845/938 [00:10<00:01, 79.68it/s] 91%|█████████ | 854/938 [00:10<00:01, 78.05it/s] 92%|█████████▏| 863/938 [00:10<00:00, 80.79it/s] 93%|█████████▎| 872/938 [00:10<00:00, 76.93it/s] 94%|█████████▍| 880/938 [00:10<00:00, 74.46it/s] 95%|█████████▍| 888/938 [00:11<00:00, 71.47it/s] 96%|█████████▌| 897/938 [00:11<00:00, 75.77it/s] 97%|█████████▋| 907/938 [00:11<00:00, 80.29it/s] 98%|█████████▊| 916/938 [00:11<00:00, 82.17it/s] 99%|█████████▊| 925/938 [00:11<00:00, 83.28it/s]100%|█████████▉| 934/938 [00:11<00:00, 81.08it/s]100%|██████████| 938/938 [00:11<00:00, 79.29it/s]
Train Epoch: 2 	Loss: 3.042208 
Moments Accountant gives: (ε = 0.13, δ = 1e-05) for α = 99.00
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:05,  1.60it/s] 20%|██        | 2/10 [00:00<00:02,  2.80it/s] 30%|███       | 3/10 [00:00<00:01,  3.68it/s] 40%|████      | 4/10 [00:01<00:01,  4.47it/s] 50%|█████     | 5/10 [00:01<00:01,  4.93it/s] 60%|██████    | 6/10 [00:01<00:00,  5.22it/s] 70%|███████   | 7/10 [00:01<00:00,  5.66it/s] 80%|████████  | 8/10 [00:01<00:00,  5.78it/s] 90%|█████████ | 9/10 [00:01<00:00,  5.80it/s]100%|██████████| 10/10 [00:02<00:00,  6.55it/s]100%|██████████| 10/10 [00:02<00:00,  4.60it/s]

Test set: Average loss: 0.0046, Accuracy: 6401/10000 (64.01%)

Training membership inference attack model
Base model accuracy:  0.6401
Random forest model attack results: 
train acc: 0.99995
test acc: 0.5
total acc: 0.9285285714285715
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:01<00:09,  1.11s/it] 20%|██        | 2/10 [00:01<00:04,  1.71it/s] 30%|███       | 3/10 [00:01<00:02,  2.45it/s] 40%|████      | 4/10 [00:01<00:01,  3.01it/s] 50%|█████     | 5/10 [00:01<00:01,  3.41it/s] 60%|██████    | 6/10 [00:02<00:01,  3.89it/s] 70%|███████   | 7/10 [00:02<00:00,  4.09it/s] 80%|████████  | 8/10 [00:02<00:00,  4.41it/s] 90%|█████████ | 9/10 [00:02<00:00,  4.65it/s]100%|██████████| 10/10 [00:02<00:00,  5.19it/s]100%|██████████| 10/10 [00:03<00:00,  3.25it/s]

Test set: Average loss: 0.0046, Accuracy: 6401/10000 (64.01%)

Thu Jun  3 13:17:10 2021       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 460.73.01    Driver Version: 460.73.01    CUDA Version: 11.2     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  Tesla T4            On   | 00000000:00:07.0 Off |                    0 |
| N/A   50C    P0    28W /  70W |      0MiB / 15109MiB |     49%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+
 13:17:10 up 28 days,  5:36,  2 users,  load average: 16.50, 16.57, 17.03
